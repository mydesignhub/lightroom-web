import React, { useState, useEffect, useRef } from 'react';
import { 
  Sun, Aperture, Droplet, Sliders, ChevronRight, CheckCircle, XCircle, 
  BookOpen, Award, PlayCircle, MessageCircle, Send, Sparkles, Loader2, 
  Bot, Settings, HelpCircle, BarChart, Zap, Triangle, Touchpad, 
  AlertTriangle, RotateCcw, Globe, RefreshCw, Layout, Image as ImageIcon, 
  Lightbulb, Palette, X, WifiOff, Download, TrendingUp, Share2, Clipboard, Camera,
  Layers, Crop, Save, ScanFace, Shuffle, Lock, Key
} from 'lucide-react';

// ==========================================
// 1. GEMINI API CONFIGURATION
// ==========================================

let apiKey = ""; 
try {
  // @ts-ignore
  apiKey = import.meta.env.VITE_GEMINI_API_KEY || "";
} catch (e) {
  console.log("Running in Preview Mode (No API Key)");
  apiKey = ""; 
}

// CACHE SYSTEM FOR CHAT
const responseCache = new Map();

const callGemini = async (prompt, systemInstruction = "", jsonMode = false) => {
  if (!apiKey) return null;

  const cacheKey = JSON.stringify({ prompt, jsonMode });
  if (responseCache.has(cacheKey)) {
    return responseCache.get(cacheKey);
  }

  const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
  
  const payload = {
    contents: [{ parts: [{ text: prompt }] }],
    systemInstruction: { parts: [{ text: systemInstruction }] },
    generationConfig: jsonMode ? { responseMimeType: "application/json" } : {}
  };

  const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));

  for (let attempt = 0; attempt < 3; attempt++) {
    try {
      const response = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      if (response.status === 429 || response.status === 503) {
         console.warn(`AI is busy... Retrying attempt ${attempt + 1}`);
         await wait(2000 * (attempt + 1)); 
         continue; 
      }

      if (!response.ok) throw new Error(`API Error: ${response.status}`);
      
      const data = await response.json();
      let text = data.candidates?.[0]?.content?.parts?.[0]?.text;
      
      if (jsonMode && text) {
          text = text.replace(/```json/g, '').replace(/```/g, '').trim();
          text = JSON.parse(text);
      }

      responseCache.set(cacheKey, text);
      return text; 
      
    } catch (error) {
      console.error("Gemini API Error:", error);
      if (attempt === 2) return null;
    }
  }
  return null;
};

// ==========================================
// 2. ICONS & ASSETS
// ==========================================

const FacebookIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z" />
  </svg>
);

// ==========================================
// 3. DATABASES (LOCAL & CACHED AI)
// ==========================================

const AI_CACHE_DB = {
  "áá¾ Dehaze á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á¢áŸ’áœá¸?": "Dehaze á‚áºá‡á¶á§á”á€ášááŸáŠáŸá¢áŸáŸ’á…á¶ášáŸ’á™áŸá˜áŸ’ášá¶á”áŸ‹áŸ–\n\nâ€¢ **á€á¶ááŸ‹á”á“áŸ’áá™á¢áŸá–áŸ’á‘/á•áŸ’áŸáŸ‚á„áŸ–** á’áŸ’áœá¾á±áŸ’á™ášá¼á”á—á¶á–áŠáŸ‚á›áŸáŸ’ášá¢á¶á”áŸ‹á˜á¾á›á‘áŸ…á…áŸ’á”á¶áŸáŸ‹á“á·á„áŠá·áá¡á¾á„áœá·á‰áŸ”\nâ€¢ **á”á“áŸ’ááŸ‚á˜á–ááŸŒá˜áŸáƒáŸ–** á’áŸ’áœá¾á±áŸ’á™á˜áŸáƒá–ááŸŒááŸ€áœá€á¶á“áŸ‹ááŸ‚áŠá·á á“á·á„áƒá¾á‰á–á–á€á…áŸ’á”á¶áŸáŸ‹áŸ”\nâ€¢ **á”á„áŸ’á€á¾á Effect áŸáŸ’ášá‘á“áŸ‹áŸ–** á”á¾á‘á¶á‰á‘áŸ…áá¶á„á†áŸ’áœáŸá„ (Negative) áœá¶á“á¹á„á”á„áŸ’á€á¾áá¢áŸá–áŸ’á‘áŸá·á”áŸ’á”á“á·á˜áŸ’á˜á·á á’áŸ’áœá¾á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ… DreamyáŸ”",
  "á…á„áŸ‹á€áŸ‚ášá¼á”á”áŸ‚á” Vintage": "áŠá¾á˜áŸ’á”á¸á‘á‘á½á›á”á¶á“ášá¼á”á”áŸ‚á” Vintage (á”á»ášá¶á) áŸá¼á˜áŸá¶á€á›áŸ’á”á„áŸ–\n\nâ€¢ **Curve:** á›á¾á€á…áŸ†áá»á…ááŸ’á˜áŸ…áá¶á„á†áŸ’áœáŸá„á€áŸ’ášáŸ„á˜á¡á¾á„á›á¾á”á“áŸ’áá·á… (Lifted Blacks) áŠá¾á˜áŸ’á”á¸á±áŸ’á™á–ááŸŒááŸ’á˜áŸ…á”áŸ’ášáŸ‚á‡á¶á”áŸ’ášá•áŸáŸ‡áŸ”\nâ€¢ **Color:** á”á“áŸ’áá™ Saturation (-20) á“á·á„á”á“áŸ’ááŸ‚á˜á–ááŸŒá›á¿á„ (Temp +) á”á“áŸ’áá·á…áŸ”\nâ€¢ **Effects:** á”á“áŸ’ááŸ‚á˜ Grain (+20 á‘áŸ… +40) áŠá¾á˜áŸ’á”á¸á±áŸ’á™áŠá¼á…ášá¼á”ááá áŸ’áœá¸á›áŸ”\nâ€¢ **Vignette:** áŠá¶á€áŸ‹á”á“áŸ’áá·á… (-15) áŠá¾á˜áŸ’á”á¸á±áŸ’á™á‚áŸ‚á˜á„á„á¹ááŸ”",
  "ášá¼á”á„á„á¹áá–áŸá€ á’áŸ’áœá¾á˜áŸ‰áŸá…?": "á”á¾ášá¼á”á„á„á¹áá–áŸá€ áŸá¼á˜á€áŸ‚áá¶á˜á›áŸ†áŠá¶á”áŸ‹á“áŸáŸ‡áŸ–\n\n1. **Exposure (+):** áá˜áŸ’á›á¾á„á–á“áŸ’á›áºášá½á˜á‡á¶á˜á»á“áŸá·á“áŸ”\n2. **Shadows (+):** áá˜áŸ’á›á¾á„áŠá¾á˜áŸ’á”á¸á”áŸ†á—áŸ’á›áºááŸ‚á•áŸ’á“áŸ‚á€á„á„á¹á (á€á»áŸ†á±áŸ’á™á”áŸ‰áŸ‡á–á¶á›áŸ‹á•áŸ’á“áŸ‚á€á—áŸ’á›áº)áŸ”\n3. **Whites (+):** áá˜áŸ’á›á¾á„á”á“áŸ’áá·á…áŠá¾á˜áŸ’á”á¸á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ…á—áŸ’á›áºááŸ’á›á¶áŸ”\n\nâš ï¸ á”áŸ’ášá™áŸááŸ’á“áŸ– á€á¶ášáá˜áŸ’á›á¾á„á–á“áŸ’á›áºááŸ’á›á¶áŸ†á„á¢á¶á…á’áŸ’áœá¾á±áŸ’á™ášá¼á”á˜á¶á“á‚áŸ’ášá¶á”áŸ‹ (Noise) áŠá¼á…áŸ’á“áŸáŸ‡á€á»áŸ†á—áŸ’á›áŸá…á”áŸ’ášá¾ Noise Reduction á”á¾á…á¶áŸ†á”á¶á…áŸ‹áŸ”",
  "áŸá»áŸ†ášá¼á”á˜á“áŸ’áá€áŸ‚ášá¼á”á”áŸ‚á” Cinematic": "ášá¼á”á˜á“áŸ’á Cinematic áŠáŸá–áŸá‰á“á·á™á˜ (Teal & Orange)áŸ–\n\nâ€¢ **Calibration:** Blue Primary (Hue -50, Sat +50), Red Primary (Hue +20, Sat -20)áŸ”\nâ€¢ **Color Grading:** Shadows (Teal/Blue), Highlights (Orange/Yellow)áŸ”\nâ€¢ **Light:** Contrast ááŸ’á–áŸáŸ‹á”á“áŸ’áá·á…, Blacks á”á“áŸ’áá™á…á»áŸ‡áŸ”\nâ€¢ **Crop:** á€á¶ááŸ‹ášá¼á”á‡á¶áŸá˜á¶á˜á¶ááŸ’áš 16:9 á¬ 2.35:1 áŠá¾á˜áŸ’á”á¸á±áŸ’á™áŠá¼á…á€á»á“áŸ”",
  "ášá”áŸ€á”á’áŸ’áœá¾á¢áŸ„á™áŸáŸ’á”áŸ‚á€áŸ?": "á“áŸ…á€áŸ’á“á»á„ Lightroom á¢áŸ’á“á€á¢á¶á…á’áŸ’áœá¾á±áŸ’á™áŸáŸ’á”áŸ‚á€áŸáŠáŸ„á™áŸ–\n\n1. á…á¼á›á‘áŸ…á€á¶á“áŸ‹ **Color Mix** (á¬ Color Mixer)áŸ”\n2. á‡áŸ’ášá¾áŸášá¾áŸá–ááŸŒ **á‘á¹á€á€áŸ’ášá¼á… (Orange)**áŸ”\n3. **Luminance (+):** áá˜áŸ’á›á¾á„áŠá¾á˜áŸ’á”á¸á±áŸ’á™áŸáŸ’á”áŸ‚á€á—áŸ’á›áº/áŸáŸ”\n4. **Saturation (-):** á”á“áŸ’áá™á”á“áŸ’áá·á…á”á¾áŸáŸ’á”áŸ‚á€á€áŸ’ášá á˜á–áŸá€áŸ”\n\ná€á»áŸ†á”áŸ’ášá¾ Exposure ášá½á˜ á–áŸ’ášáŸ„áŸ‡áœá¶á“á¹á„á’áŸ’áœá¾á±áŸ’á™á—áŸ’á›áºá‘á¶áŸ†á„ BackgroundáŸ”",
  "á€áŸ‚ášá¼á”ááá–áŸá›á™á”áŸ‹á¢áŸ„á™áŸáŸ’á¢á¶á": "á‚á“áŸ’á›á¹áŸ‡á€áŸ‚ášá¼á”ááá–áŸá›á™á”áŸ‹áŸ–\n\nâ€¢ **Highlights (-):** á”á“áŸ’áá™áŠá¾á˜áŸ’á”á¸á€á»áŸ†á±áŸ’á™á—áŸ’á›á¾á„á¢áŸ†á–á¼á›á…á¶áŸ†á„ááŸ’á›á¶áŸ†á„á–áŸá€áŸ”\nâ€¢ **Shadows (+):** áá˜áŸ’á›á¾á„áŠá¾á˜áŸ’á”á¸á±áŸ’á™áƒá¾á‰á–áŸááŸŒá˜á¶á“á›á˜áŸ’á¢á·áá€áŸ’á“á»á„á‘á¸á„á„á¹ááŸ”\nâ€¢ **Temp:** á€áŸ‚áŸá¸áá»ááŸ’á á—á¶á–á–ááŸŒ á€á»áŸ†á±áŸ’á™á‡á¶á”áŸ‹á›á¿á„á–áŸá€ (á—áŸ’á›á¾á„á•áŸ’á›á¼áœ)áŸ”\nâ€¢ **Noise Reduction:** á…á¶áŸ†á”á¶á…áŸ‹áá¶áŸáŸ‹! áŠá¶á€áŸ‹á”áŸ’ášá áŸ‚á› 20-30 áŠá¾á˜áŸ’á”á¸á›á»á”á‚áŸ’ášá¶á”áŸ‹áŸ”",
  "ášá”áŸ€á”áŠá¶á€áŸ‹á–ááŸŒ Teal & Orange": "ášá”áŸ€á”á„á¶á™áŸ—áŸ–\n\n1. **Profiles:** á”áŸ’ášá¾ Profile 'Modern 08' á¬ 'Artistic 04' á‡á¶á˜á¼á›áŠáŸ’á‹á¶á“áŸ”\n2. **Color Mix:**\n   - Blue: Hue á‘áŸ…á†áŸ’áœáŸá„ (Aqua), Saturation (+)\n   - Orange: Saturation (+), Luminance (+)\n   - Green: Hue á‘áŸ…á†áŸ’áœáŸá„ (Yellow), Saturation (-)\n3. **Grading:** Shadows áŠá¶á€áŸ‹á–ááŸŒ Teal, Highlights áŠá¶á€áŸ‹á–ááŸŒ OrangeáŸ”",
  "á–á“áŸ’á™á›áŸ‹á–á¸ Curves": "Tone Curve á‚áºá‡á¶á§á”á€ášááŸá€áŸ‚á–á“áŸ’á›áºá€á˜áŸ’ášá·áááŸ’á–áŸáŸ‹áŸ–\n\nâ€¢ **ááŸ’áŸáŸ‚á”á“áŸ’á‘á¶ááŸ‹ (Line):** ááŸ†áá¶á„á±áŸ’á™á–á“áŸ’á›áºá–á¸ ááŸ’á˜áŸ… (á†áŸ’áœáŸá„) á‘áŸ… áŸ (áŸáŸ’áá¶áŸ†)áŸ”\nâ€¢ **S-Curve:** áŠá¶á€áŸ‹á…áŸ†áá»á… áŸ£ (Highlights á¡á¾á„, Midtones á“áŸ…áŸáŸ’á„áŸ€á˜, Shadows á…á»áŸ‡) áŠá¾á˜áŸ’á”á¸á”á„áŸ’á€á¾á Contrast áŸáŸ’á¢á¶ááŸ”\nâ€¢ **Lifted Blacks:** á‘á¶á‰á…áŸ†áá»á…ááŸ’á˜áŸ…á”áŸ†á•á»á (á†áŸ’áœáŸá„á€áŸ’ášáŸ„á˜) á¡á¾á„á›á¾á”á“áŸ’áá·á… áŠá¾á˜áŸ’á”á¸á”á¶á“á–ááŸŒ Faded/MatteáŸ”",
  "áá¾ Grain á‡á½á™á¢áŸ’áœá¸ááŸ’á›áŸ‡?": "Grain (á‚áŸ’ášá¶á”áŸ‹) á˜á·á“á˜áŸ‚á“á¢á¶á€áŸ’ášá€áŸ‹á‘á¶áŸ†á„á¢áŸáŸ‹á‘áŸáŸ–\n\n1. **Aesthetic:** á’áŸ’áœá¾á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ…á˜á¶á“áŸá·á›áŸ’á”áŸˆáŠá¼á…áááŠáŸ„á™á áŸ’áœá¸á›á€á¶á˜áŸášáŸ‰á¶áŸ”\n2. **Masking Noise:** á”á¾á€áŸ‚ášá¼á”á™á”áŸ‹á á¾á™ Noise Reduction á’áŸ’áœá¾á±áŸ’á™ášá¼á”ášá›áŸ„á„á–áŸá€ (Plastic look) á€á¶ášá”á“áŸ’ááŸ‚á˜ Grain á”á“áŸ’áá·á…á¢á¶á…á‡á½á™á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ…á˜á¶á“ Texture á’á˜áŸ’á˜á‡á¶áá·áœá·á‰áŸ”",
  "ášá”áŸ€á”á€áŸ‚ášá¼á” Portrait á¢áŸ„á™áŸáŸ’á¢á¶á": "áŸá˜áŸ’ášá¶á”áŸ‹ášá¼á”á˜á“á»áŸáŸ’áŸ (Portrait)áŸ–\n\nâ€¢ **Face:** á”áŸ’ášá¾ 'Vibrance' á‡áŸ†á“á½áŸ 'Saturation'áŸ”\nâ€¢ **Skin:** á€áŸ‚á–ááŸŒ Orange Luminance á±áŸ’á™áŸáŸ’á”áŸ‚á€á—áŸ’á›áºáŸ”\nâ€¢ **Details:** á”á“áŸ’áá™ Texture/Clarity á”á“áŸ’áá·á… (-10) áŠá¾á˜áŸ’á”á¸á±áŸ’á™áŸáŸ’á”áŸ‚á€á˜áŸ‰ááŸ‹ (á¬á”áŸ’ášá¾ Masking á›á¾ááŸ‚á˜á»á)áŸ”\nâ€¢ **Eyes:** á”áŸ’ášá¾ Brush áá˜áŸ’á›á¾á„ Exposure á“á·á„ Clarity á›á¾á‚áŸ’ášá¶á”áŸ‹á—áŸ’á“áŸ‚á€á±áŸ’á™á—áŸ’á›áºáŸ”",
  "áá¾ Clarity áá»áŸá–á¸ Texture á™áŸ‰á¶á„áá¶?": "á‘á¶áŸ†á„á–á¸ášá“áŸáŸ‡á’áŸ’áœá¾á±áŸ’á™ášá¼á”á…áŸ’á”á¶áŸáŸ‹áŠá¼á…á‚áŸ’á“á¶ á”áŸ‰á»á“áŸ’ááŸ‚áŸ–\n\nâ€¢ **Texture:** á”áŸ‰áŸ‡á–á¶á›áŸ‹ááŸ‚á–áŸááŸŒá˜á¶á“á›á˜áŸ’á¢á·ááá¼á…áŸ— (áŸáŸ’á”áŸ‚á€, á•áŸ’á‘áŸƒáœááŸ’áá»)áŸ” á›áŸ’á¢áŸá˜áŸ’ášá¶á”áŸ‹á’áŸ’áœá¾á±áŸ’á™áŸáŸ’á”áŸ‚á€á˜áŸ‰ááŸ‹ (á–áŸá›á”á“áŸ’áá™)áŸ”\nâ€¢ **Clarity:** á”áŸ‰áŸ‡á–á¶á›áŸ‹ Contrast á“áŸ…á€ááŸ’áá¶á› (Midtones)áŸ” áœá¶ááŸ’á›á¶áŸ†á„á‡á¶á„ TextureáŸ” á€á¶ášá”áŸ’ášá¾ Clarity ááŸ’á›á¶áŸ†á„á–áŸá€á’áŸ’áœá¾á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ…á€ááŸ’áœá€áŸ‹ á¬ááŸ’á˜áŸ…áŸ”",
  "ášá”áŸ€á”á€áŸ‚á–ááŸŒá˜áŸáƒá¢áŸ„á™áŠá·á?": "áœá·á’á¸á’áŸ’áœá¾á±áŸ’á™á˜áŸáƒááŸ€áœáŠá·ááŸ–\n\n1. **HSL:** á…á¼á›á–ááŸŒ Blue -> á”á“áŸ’áá™ Luminance (-) á“á·á„áá˜áŸ’á›á¾á„ Saturation (+)áŸ”\n2. **Masking:** á”áŸ’ášá¾ 'Select Sky' -> á”á“áŸ’áá™ Exposure á”á“áŸ’áá·á…, á”á“áŸ’áá™ Highlights, á“á·á„áá˜áŸ’á›á¾á„ DehazeáŸ”",
  "áá¾ RAW á“á·á„ JPG áá»áŸá‚áŸ’á“á¶á™áŸ‰á¶á„áá¶?": "â€¢ **RAW (DNG):** á•áŸ’á‘á»á€á–áŸááŸŒá˜á¶á“á‘á¶áŸ†á„á¢áŸáŸ‹á–á¸á€á¶á˜áŸášáŸ‰á¶áŸ” á¢á¶á…á€áŸ‚á–á“áŸ’á›áºá“á·á„á–ááŸŒá”á¶á“á…áŸ’ášá¾á“áŠáŸ„á™á˜á·á“á”áŸ‚á€ášá¼á”áŸ” (ááŸ‚á“á¶áŸ†á±áŸ’á™á”áŸ’ášá¾)\nâ€¢ **JPG:** ášá¼á”á—á¶á–ááŸ’ášá¼áœá”á¶á“á€áŸ‚á“á·á„á”á„áŸ’ášá½á˜ášá½á…áŸ” áŸáŸ’ášá¶á› á”áŸ‰á»á“áŸ’ááŸ‚á–áŸá›á€áŸ‚ááŸ’á›á¶áŸ†á„á„á¶á™á“á¹á„á”áŸ‚á€ á¬áá¼á…á–ááŸŒáŸ”",
  "ášá”áŸ€á”á›á»á”á˜á»á“á€áŸ’á“á»á„ Lightroom?": "á”áŸ’ášá¾á§á”á€ášááŸ **Healing Brush** (ášá¼á”á”á·á‘áŠáŸ†á”áŸ…)áŸ–\n\n1. á‡áŸ’ášá¾áŸášá¾áŸá”áŸ’ášá—áŸá‘ 'Heal' (á˜á·á“á˜áŸ‚á“ Clone)áŸ”\n2. á…á»á…á›á¾á‚áŸ’ášá¶á”áŸ‹á˜á»á“ á¬áŸáŸ’á“á¶á˜áŸ”\n3. Lightroom á“á¹á„á™á€áŸáŸ’á”áŸ‚á€áŸáŸ’á¢á¶áá–á¸á€á“áŸ’á›áŸ‚á„á•áŸ’áŸáŸá„á˜á€á‡áŸ†á“á½áŸáŠáŸ„á™áŸáŸ’áœáŸá™á”áŸ’ášáœááŸ’áá·áŸ”",
  "áá¾ Vignette á”áŸ’ášá¾á–áŸá›áá¶?": "Vignette (á’áŸ’áœá¾á±áŸ’á™á‚áŸ‚á˜á„á„á¹á) á‚á½ášá”áŸ’ášá¾á“áŸ…á‡áŸ†á á¶á“á…á»á„á€áŸ’ášáŸ„á™áŸ” áœá¶á‡á½á™á”á·á‘á”á¶áŸ†á„á¢áŸ’áœá¸áŠáŸ‚á›ášá‰áŸ‰áŸášá‰áŸ‰áŸƒá“áŸ…á‚áŸ‚á˜ášá¼á” á“á·á„ášá»á‰á€á¶ášá…á¶á”áŸ‹á¢á¶ášá˜áŸ’á˜ááŸášá”áŸáŸ‹á¢áŸ’á“á€á˜á¾á›á‘áŸ…á€á¶á“áŸ‹á€ááŸ’áá¶á›ášá¼á”á—á¶á– (Subject)áŸ”",
  "ášá”áŸ€á”á’áŸ’áœá¾á¢áŸ„á™ášá¼á”á…áŸ’á”á¶áŸáŸ‹ (Sharp)?": "â€¢ **Sharpening:** áá˜áŸ’á›á¾á„á€á˜áŸ’ášá·á 40-50áŸ”\nâ€¢ **Masking (áŸáŸ†áá¶á“áŸ‹):** á…á»á…á–á¸ášá˜áŸ’ášá¶á˜áŠáŸƒ (á¬ Alt) á–áŸá›á¢á¼áŸ Slider 'Masking'áŸ” á¢á¼áŸášá á¼ááŠá›áŸ‹áƒá¾á‰á–ááŸŒáŸááŸ‚á“áŸ…áá¶á˜á‚áŸ‚á˜áœááŸ’áá»áŸ” á“áŸáŸ‡á‡á½á™á±áŸ’á™á…áŸ’á”á¶áŸáŸ‹ááŸ‚á‚áŸ‚á˜ á˜á·á“á’áŸ’áœá¾á±áŸ’á™á•áŸ’á‘áŸƒášá›áŸ„á„ (áŠá¼á…áŸáŸ’á”áŸ‚á€/á˜áŸáƒ) á˜á¶á“á‚áŸ’ášá¶á”áŸ‹áŸ”",
  "áá¾ HSL á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á¢áŸ’áœá¸?": "HSL á‚áºá‡á¶á”áŸáŸ‡áŠá¼á„á“áŸƒá€á¶ášá€áŸ‚á–ááŸŒáŸ–\n\nâ€¢ **H (Hue):** á”áŸ’áá¼ášá–ááŸŒ (á§. á”áŸ’áá¼ášáŸáŸ’á›á¹á€áˆá¾á–á¸á”áŸƒáá„á‘áŸ…á›á¿á„)áŸ”\nâ€¢ **S (Saturation):** á€áŸ†áááŸ‹á—á¶á–áŠá·áá“áŸƒá–ááŸŒá“áŸ„áŸ‡áŸ”\nâ€¢ **L (Luminance):** á€áŸ†áááŸ‹á–á“áŸ’á›áºá“áŸƒá–ááŸŒá“áŸ„áŸ‡ (á’áŸ’áœá¾á±áŸ’á™á–ááŸŒá“áŸ„áŸ‡á—áŸ’á›áºá¬á„á„á¹á)áŸ”",
  "ášá”áŸ€á” Copy Settings á‘áŸ…ášá¼á”á•áŸ’áŸáŸá„?": "áŠá¾á˜áŸ’á”á¸á…áŸ†ááŸá‰á–áŸá›áŸ–\n\n1. á€áŸ‚ášá¼á”á‘á¸ áŸ¡ á±áŸ’á™áŸáŸ’á¢á¶ááŸ”\n2. á…á»á…áŸá‰áŸ’á‰á¶ ... (More) -> Copy SettingsáŸ”\n3. á”á¾á€ášá¼á”á‘á¸ áŸ¢ -> á…á»á… ... -> Paste SettingsáŸ”\n\náœá¶á“á¹á„á¢á“á»áœááŸ’áá€á¶ášá€áŸ‚á‘á¶áŸ†á„á¢áŸáŸ‹á‘áŸ…ášá¼á”ááŸ’á˜á¸áŸ”",
  "áá¾ Color Grading á”áŸ’ášá¾áŠá¾á˜áŸ’á”á¸á¢áŸ’áœá¸?": "Color Grading (Split Toning) á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á”á“áŸ’ááŸ‚á˜á–ááŸŒá¢á¶ášá˜áŸ’á˜ááŸ (Mood) á‘áŸ…á€áŸ’á“á»á„ášá¼á”áŸ”\n\nâ€¢ áá»áŸá–á¸ HSL áŠáŸ‚á›á€áŸ‚á–ááŸŒáŠáŸ‚á›á˜á¶á“áŸáŸ’ášá¶á”áŸ‹, Grading á¢á¶á…áŠá¶á€áŸ‹á–ááŸŒááŸ’á˜á¸á…á¼á›á‘áŸ…á€áŸ’á“á»á„ Shadows (á˜áŸ’á›á”áŸ‹) á“á·á„ Highlights (á€á“áŸ’á›áŸ‚á„á—áŸ’á›áº)áŸ”",
  "á‚á“áŸ’á›á¹áŸ‡ááášá¼á”á–áŸá›ááŸ’á„áŸƒá›á·á…?": "â€¢ **Golden Hour:** ááá˜á»á“ááŸ’á„áŸƒá›á·á… áŸ¡ á˜áŸ‰áŸ„á„ á–á“áŸ’á›áºá“á¹á„á‘á“áŸ‹á“á·á„á˜á¶á“á–ááŸŒá˜á¶áŸáŸ”\nâ€¢ **Underexpose:** ááá±áŸ’á™á„á„á¹áá”á“áŸ’áá·á… áŠá¾á˜áŸ’á”á¸á€á»áŸ†á±áŸ’á™á”á¶ááŸ‹á–ááŸŒá˜áŸáƒáŸ” á€áŸ’á“á»á„ Lightroom á¢á¶á…áá˜áŸ’á›á¾á„ Shadows á˜á€áœá·á‰á”á¶á“ ááŸ‚á”á¾á˜áŸáƒáŸ (Overexposed) á‚áºá€áŸ‚á˜á·á“á”á¶á“á‘áŸáŸ”"
};

const TIP_DATABASE = [
  "á”áŸ’ášá¾ 'Auto' á‡á¶á…áŸ†áá»á…á…á¶á”áŸ‹á•áŸ’áá¾á˜ ášá½á…á€áŸ‚áá˜áŸ’ášá¼áœáá¶á˜á€áŸ’ášáŸ„á™ áŠá¾á˜áŸ’á”á¸á…áŸ†ááŸá‰á–áŸá›áŸ”",
  "á…á»á…áŸá„áŸ’á€ááŸ‹á›á¾ášá¼á”áŠá¾á˜áŸ’á”á¸á˜á¾á› Before/After á”áŸ’ášáŸ€á”á’áŸ€á”á›á‘áŸ’á’á•á›áŸ”",
  "á…á»á…á–á¸ášáŠá„á›á¾ Slider áŠá¾á˜áŸ’á”á¸ Reset áœá¶á‘áŸ…áá˜áŸ’á›áŸƒ 0 áœá·á‰áŸ”",
  "á”áŸ’ášá¾á˜áŸ’ášá¶á˜áŠáŸƒá–á¸ášá›á¾ Slider (Whites/Blacks) áŠá¾á˜áŸ’á”á¸á˜á¾á›á€á“áŸ’á›áŸ‚á„áŠáŸ‚á›á”á¶ááŸ‹á–áŸááŸŒá˜á¶á“ (Clipping)áŸ”",
  "á”á“áŸ’áá™ Highlights (-50 áŠá›áŸ‹ -100) áŠá¾á˜áŸ’á”á¸áŸá„áŸ’á‚áŸ’ášáŸ„áŸ‡á–áŸááŸŒá˜á¶á“á›á˜áŸ’á¢á·áá€áŸ’á“á»á„á˜áŸáƒáŸ”",
  "áá˜áŸ’á›á¾á„ Shadows (+30 áŠá›áŸ‹ +60) áŠá¾á˜áŸ’á”á¸á˜á¾á›áƒá¾á‰ášá”áŸáŸ‹á€áŸ’á“á»á„á˜áŸ’á›á”áŸ‹á…áŸ’á”á¶áŸáŸ‹á‡á¶á„á˜á»á“áŸ”",
  "á”áŸ’ášá¾ Masking 'Select Sky' áŠá¾á˜áŸ’á”á¸á€áŸ‚á–ááŸŒá˜áŸáƒá¢áŸ„á™áŠá·ááŸáŸ’á¢á¶á áŠáŸ„á™á˜á·á“á”áŸ‰áŸ‡á–á¶á›áŸ‹áŠá¸áŸ”",
  "á”áŸ’ášá¾ Healing Brush áŠá¾á˜áŸ’á”á¸á›á»á”á˜á»á“ á¬áœááŸ’áá»áŠáŸ‚á›á˜á·á“á…á„áŸ‹á”á¶á“á…áŸá‰á–á¸ášá¼á”á—á¶á–áŸ”",
  "á€á»áŸ†á”áŸ’ášá¾ Clarity ááŸ’á›á¶áŸ†á„á–áŸá€á›á¾á˜á»áá˜á“á»áŸáŸ’áŸ (Portrait) á–áŸ’ášáŸ„áŸ‡áœá¶á’áŸ’áœá¾á±áŸ’á™áƒá¾á‰áŸáŸ’á“á¶á˜á€á¶á“áŸ‹ááŸ‚á…áŸ’á”á¶áŸáŸ‹áŸ”",
  "á”áŸ’ášá¾ Vibrance á‡áŸ†á“á½áŸ Saturation áŠá¾á˜áŸ’á”á¸á‘á‘á½á›á”á¶á“á–ááŸŒáŸáŸ’á”áŸ‚á€á’á˜áŸ’á˜á‡á¶áá·á‡á¶á„áŸ”",
  "Export á‡á¶ DNG áŠá¾á˜áŸ’á”á¸á…áŸ‚á€ášáŸ†á›áŸ‚á€ Preset á‘áŸ…á±áŸ’á™á˜á·ááŸ’áá—á€áŸ’áá·áŸ”",
  "á”áŸ’ášá¾ Grid (Rule of Thirds) á–áŸá›áá áŠá¾á˜áŸ’á”á¸á±áŸ’á™ášá¼á”á˜á¶á“áŸá˜á¶áŸá—á¶á–á›áŸ’á¢áŸ”",
  "á”á¾á€ 'Lens Profile Corrections' á‡á¶á“á·á…áŸ’á… áŠá¾á˜áŸ’á”á¸á€áŸ‚á—á¶á–á€áŸ„á„á“áŸƒá€áŸ‚áœáááŸ”",
  "á”áŸ’ášá¾ 'Upright' -> 'Auto' áŸá˜áŸ’ášá¶á”áŸ‹ášá¼á”ááá¢á‚á¶áš áŠá¾á˜áŸ’á”á¸á±áŸ’á™áŸášáŸášááŸ’ášá„áŸ‹áŸ”",
  "áŠá¶á€áŸ‹á•áŸ’á€á¶á™ (Rate) ášá¼á”áŠáŸ‚á›á…á¼á›á…á·ááŸ’á áŠá¾á˜áŸ’á”á¸á„á¶á™áŸáŸ’ášá½á›ášá€á–áŸá›á€áŸ’ášáŸ„á™áŸ”",
  "á”áŸ’ášá¾ Color Noise Reduction (25-30) áŸá˜áŸ’ášá¶á”áŸ‹ášá¼á”ááá™á”áŸ‹ áŠá¾á˜áŸ’á”á¸á€á¶ááŸ‹á”á“áŸ’áá™á‚áŸ’ášá¶á”áŸ‹á–ááŸŒáŸ”",
  "á€á»áŸ† Sharpen ááŸ’á›á¶áŸ†á„á–áŸá€ á”áŸ’ášá™áŸááŸ’á“ášá¼á”áá¼á…á‚á»áá—á¶á–áŸ”",
  "á’áŸ’áœá¾á±áŸ’á™á’áŸ’á˜áŸá‰áŸáŸ– á”áŸ’ášá¾ Brush -> Saturation (-50) -> Exposure (+20)áŸ”",
  "á”áŸ’ášá¾ S-Curve á”á“áŸ’áá·á… áŠá¾á˜áŸ’á”á¸á±áŸ’á™ášá¼á”á˜á¶á“á‡á˜áŸ’ášáŸ… (Pop) á“á·á„ Contrast áŸáŸ’á¢á¶ááŸ”",
  "á”áŸ’ášá¾ Calibration (Blue Primary) áŠá¾á˜áŸ’á”á¸á”áŸ’áá¼ášá–ááŸŒáŸáŸ’á›á¹á€áˆá¾á±áŸ’á™á”áŸ’á›áŸ‚á€áŸ”",
  "á’áŸ’áœá¾á±áŸ’á™áŸáŸ’á˜áŸ…á”áŸƒáá„ááŸ’á…á¸áŸ– HSL -> Green -> Hue á‘áŸ…á†áŸ’áœáŸá„ (Yellowish)áŸ”",
  "á”á“áŸ’áá™ Dehaze á‘áŸ…á†áŸ’áœáŸá„á”á“áŸ’áá·á… áŠá¾á˜áŸ’á”á¸á”á„áŸ’á€á¾á Effect áŠá¼á…áŸá»á”á·á“ (Dreamy)áŸ”",
  "á”áŸ’ášá¾ Grain á”á“áŸ’áá·á… (10-15) áŠá¾á˜áŸ’á”á¸á”á·á‘á”á¶áŸ†á„ Noise á“á·á„á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ…áŠá¼á… FilmáŸ”",
  "á”áŸ’ášá¾ Vignette áŠá¾á˜áŸ’á”á¸á±áŸ’á™á‚áŸá•áŸ’ááŸ„áá›á¾á€ááŸ’áá¶á›ášá¼á” (Subject)áŸ”",
  "á€á¶ááŸ‹ášá¼á” 4:5 áŸá˜áŸ’ášá¶á”áŸ‹ Instagram Post áŠá¾á˜áŸ’á”á¸á”á¶á“á–áŸá‰á¢áŸá€áŸ’ášá„áŸ‹áŸ”",
  "á€á¶ááŸ‹ášá¼á” 9:16 áŸá˜áŸ’ášá¶á”áŸ‹ Story á¬ TikTokáŸ”",
  "á”áŸ’ášá¾ Copy Settings áŠá¾á˜áŸ’á”á¸á€áŸ‚ášá¼á”á‡á¶á…áŸ’ášá¾á“á€áŸ’á“á»á„á–áŸá›ááŸ‚á˜á½á™áŸ”",
  "á”áŸ’ášá¾ Version áŠá¾á˜áŸ’á”á¸áŸá¶á€á›áŸ’á”á„áŸáŸ’áá¶á™á•áŸ’áŸáŸá„áŸ—á›á¾ášá¼á”ááŸ‚á˜á½á™áŸ”",
  "á˜á¾á› Histogram áŠá¾á˜áŸ’á”á¸áŠá¹á„áá¶ášá¼á”á„á„á¹áá¬á—áŸ’á›áºá–áŸá€áŸ”",
  "á”áŸ’ášá¾ Range Mask áŠá¾á˜áŸ’á”á¸á€áŸ‚ááŸ‚á–ááŸŒá‡á¶á€áŸ‹á›á¶á€áŸ‹áá¶á˜á½á™áŸ”",
  "á€á»áŸ†á—áŸ’á›áŸá…á€áŸ‚ White Balance á˜á»á“á‚áŸ áŠá¾á˜áŸ’á”á¸á±áŸ’á™á–ááŸŒááŸ’ášá¹á˜ááŸ’ášá¼áœáŸ”",
  "á”áŸ’ášá¾ Temp áŠá¾á˜áŸ’á”á¸á”á„áŸ’á€á¾áá¢á¶ášá˜áŸ’á˜ááŸ (Mood) á€á€áŸ‹á€áŸ’ááŸ… á¬ááŸ’ášá‡á¶á€áŸ‹áŸ”",
  "á”áŸ’ášá¾ Tint áŠá¾á˜áŸ’á”á¸á€áŸ‚á–ááŸŒáŸáŸ’á”áŸ‚á€áŠáŸ‚á›á‡á¶á”áŸ‹á”áŸƒáá„áŸ”",
  "á”áŸ’ášá¾ B&W (áŸááŸ’á˜áŸ…) á”áŸ’ášáŸá·á“á”á¾á–á“áŸ’á›áºá›áŸ’á¢ á”áŸ‰á»á“áŸ’ááŸ‚á–ááŸŒá˜á·á“áŸáŸ’á¢á¶ááŸ”",
  "á”áŸ’ášá¾ Split Toning (Color Grading) áŸá˜áŸ’ášá¶á”áŸ‹áŠá¶á€áŸ‹á–ááŸŒá€áŸ’á“á»á„ Shadows á“á·á„ HighlightsáŸ”",
  "Lifted Blacks (Curve) á’áŸ’áœá¾á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ…áŠá¼á… Film (Vintage)áŸ”",
  "Invert Mask á‚áºá˜á¶á“á”áŸ’ášá™áŸ„á‡á“áŸááŸ’á›á¶áŸ†á„áá¶áŸáŸ‹áŸá˜áŸ’ášá¶á”áŸ‹á€áŸ‚ BackgroundáŸ”",
  "á”áŸ’ášá¾ Brush á‡á¶á˜á½á™ Flow á‘á¶á” áŠá¾á˜áŸ’á”á¸á‚á¼ášá–ááŸŒáá·á…áŸ— á›á˜áŸ’á¢á·ááŸ”",
  "á€áŸ‚á–ááŸŒá˜á¶ááŸ‹áŸ– Mask -> Brush -> Saturation (+) -> Tint (Pink)áŸ”",
  "á’áŸ’áœá¾á±áŸ’á™ášáŸ‰á¼á”á€á¼á“á€áŸ’ášá˜á»áŸ†áŸáŸ– HSL -> White -> Saturation (-)áŸ”",
  "á’áŸ’áœá¾á±áŸ’á™á‘á¹á€áŸá˜á»á‘áŸ’ášááŸ€áœáŸáŸ’á¢á¶ááŸ– HSL -> Aqua -> Hue á‘áŸ…áŸáŸ’áá¶áŸ†áŸ”",
  "á€áŸ‚á–ááŸŒááŸ’á„áŸƒá›á·á…áŸ– HSL -> Orange/Red -> Saturation (+)áŸ”"
];

const QUESTION_DATABASE = [
  { id: 1, question: "áá¾á§á”á€ášááŸá˜á½á™áá¶áŸá˜áŸ’ášá¶á”áŸ‹á€áŸ‚á–á“áŸ’á›áºá‘á¼á‘áŸ…á“áŸƒášá¼á”á—á¶á–?", options: ["Contrast", "Exposure", "Highlights", "Shadows"], correct: 1 },
  { id: 2, question: "áá¾ Vibrance áá»áŸá–á¸ Saturation á™áŸ‰á¶á„áŠá¼á…á˜áŸ’ááŸá…?", options: ["áœá¶á’áŸ’áœá¾á±áŸ’á™á–ááŸŒá‘á¶áŸ†á„á¢áŸáŸ‹áŠá·ááŸáŸ’á˜á¾á‚áŸ’á“á¶", "áœá¶á€á¶ášá–á¶ášá–ááŸŒáŸáŸ’á”áŸ‚á€á˜á·á“á±áŸ’á™áŠá·áá–áŸá€", "áœá¶á˜á·á“áá»áŸá‚áŸ’á“á¶á‘áŸ", "áœá¶áŸá˜áŸ’ášá¶á”áŸ‹ááŸ‚á€áŸ‚ášá¼á”áŸááŸ’á˜áŸ…"], correct: 1 },
  { id: 3, question: "áŠá¾á˜áŸ’á”á¸á€áŸ‚á–ááŸŒá˜áŸáƒá±áŸ’á™áŠá·ááŸáŸ’á¢á¶á áá¾á‚á½ášá€áŸ‚á–ááŸŒá¢áŸ’áœá¸á€áŸ’á“á»á„ HSL?", options: ["Green", "Orange", "Blue", "Red"], correct: 2 },
  { id: 4, question: "áá¾ Dehaze á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á¢áŸ’áœá¸?", options: ["á’áŸ’áœá¾á±áŸ’á™ášá¼á”á–áŸ’ášá¶á›", "á€á¶ááŸ‹á”á“áŸ’áá™á¬á”á“áŸ’ááŸ‚á˜á¢áŸá–áŸ’á‘", "á”áŸ’áá¼ášá–ááŸŒášá¼á”á—á¶á–", "á€á¶ááŸ‹ášá¼á”á—á¶á–"], correct: 1 },
  { id: 5, question: "á”áŸ’ášáŸá·á“á”á¾á¢áŸ’á“á€á…á„áŸ‹á±áŸ’á™á•áŸ’á‘áŸƒá˜á»áá˜áŸ‰ááŸ‹ášá›áŸ„á„ áá¾á‚á½ášá’áŸ’áœá¾áŠá¼á…á˜áŸ’ááŸá…?", options: ["áá˜áŸ’á›á¾á„ Texture", "á”á“áŸ’áá™ Texture", "áá˜áŸ’á›á¾á„ Clarity", "á”á“áŸ’áá™ Exposure"], correct: 1 },
  { id: 6, question: "áá¾ Tone Curve á˜á½á™áá¶áŠáŸ‚á›á’áŸ’áœá¾á±áŸ’á™ášá¼á”á˜á¶á“ Contrast áŸáŸ’á¢á¶á (Pop)?", options: ["Linear", "S-Curve", "Flat", "Inverted"], correct: 1 },
  { id: 7, question: "áá¾ Temp á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á€áŸ‚á¢áŸ’áœá¸?", options: ["á—á¶á–á…áŸ’á”á¶áŸáŸ‹", "áŸá¸áá»ááŸ’á á—á¶á–á–ááŸŒ (á›á¿á„/ááŸ€áœ)", "á–á“áŸ’á›áº", "á‚áŸ’ášá¶á”áŸ‹ Noise"], correct: 1 },
  { id: 8, question: "áá¾á€á¶ášá”áŸ’ášá¾ Sharpening ááŸ’á›á¶áŸ†á„á–áŸá€á“á¹á„á’áŸ’áœá¾á±áŸ’á™ášá¼á”á‘áŸ…á‡á¶á™áŸ‰á¶á„áá¶?", options: ["á…áŸ’á”á¶áŸáŸ‹áŸáŸ’á¢á¶á", "á˜á¶á“á‚áŸ’ášá¶á”áŸ‹ Noise á“á·á„áá¼á…á‚á»áá—á¶á–", "á˜á¾á›á‘áŸ…á‘á“áŸ‹", "á˜á¶á“á–ááŸŒáŸáŸ’ášáŸáŸ‹"], correct: 1 },
  { id: 9, question: "áá¾ DNG á‡á¶á”áŸ’ášá—áŸá‘ file á¢áŸ’áœá¸?", options: ["Video", "RAW Image", "Audio", "Text"], correct: 1 },
  { id: 10, question: "áá¾á§á”á€ášááŸá˜á½á™áá¶á‡á½á™á€áŸ‚ášá¼á”áŠáŸ‚á›ááá˜á€áœá¶ášáŸ á¬á˜á·á“ááŸ’ášá„áŸ‹?", options: ["Optics", "Geometry/Upright", "Detail", "Effects"], correct: 1 },
  { id: 11, question: "áá¾ HSL ááŸ†áá¶á„á±áŸ’á™á¢áŸ’áœá¸?", options: ["Hue, Saturation, Lightness", "High, Standard, Low", "Hue, Shadow, Light", "Highlight, Shadow, Luminance"], correct: 0 },
  { id: 12, question: "áá¾á’áŸ’áœá¾áŠá¼á…á˜áŸ’ááŸá…áŠá¾á˜áŸ’á”á¸á±áŸ’á™áŸáŸ’á”áŸ‚á€áŸ?", options: ["á”á“áŸ’áá™ Orange Saturation, áá˜áŸ’á›á¾á„ Orange Luminance", "áá˜áŸ’á›á¾á„ Orange Saturation", "á”á“áŸ’áá™ Red Luminance", "áá˜áŸ’á›á¾á„ Yellow Saturation"], correct: 0 },
  { id: 13, question: "áá¾ Grain á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á¢áŸ’áœá¸?", options: ["á’áŸ’áœá¾á±áŸ’á™ášá¼á”á…áŸ’á”á¶áŸáŸ‹", "á”á“áŸ’ááŸ‚á˜á‚áŸ’ášá¶á”áŸ‹áá¼á…áŸ—á”áŸ‚á” Film Look", "á›á»á” Noise", "á€áŸ‚á–ááŸŒ"], correct: 1 },
  { id: 14, question: "áá¾ Vignette á’áŸ’áœá¾á¢áŸ’áœá¸?", options: ["á’áŸ’áœá¾á±áŸ’á™á‚áŸ‚á˜ášá¼á”á„á„á¹á á¬á—áŸ’á›áº", "á’áŸ’áœá¾á±áŸ’á™ášá¼á”á€ááŸ’áá¶á›á„á„á¹á", "á”áŸ’áá¼ášá–ááŸŒášá¼á”á—á¶á–", "á€á¶ááŸ‹ášá¼á”á—á¶á–"], correct: 0 },
  { id: 15, question: "áá¾ Masking á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á¢áŸ’áœá¸?", options: ["á€áŸ‚ášá¼á”á—á¶á–á‘á¶áŸ†á„á˜á¼á›", "á€áŸ‚ááŸ†á”á“áŸ‹á‡á¶á€áŸ‹á›á¶á€áŸ‹á“áŸƒášá¼á”á—á¶á–", "áŠá¶á€áŸ‹áŸáŸŠá»á˜ášá¼á”", "Export ášá¼á”"], correct: 1 },
  { id: 16, question: "áá¾ Color Grading áá»áŸá–á¸ HSL á™áŸ‰á¶á„áá¶?", options: ["áœá¶á˜á·á“áá»áŸá‚áŸ’á“á¶á‘áŸ", "HSL á€áŸ‚á–ááŸŒá“á¸á˜á½á™áŸ—, Grading áŠá¶á€áŸ‹á–ááŸŒá›á¾ Shadows/Highlights", "Grading áŸá˜áŸ’ášá¶á”áŸ‹ááŸ‚ášá¼á”áŸááŸ’á˜áŸ…", "HSL áŸá˜áŸ’ášá¶á”áŸ‹ááŸ‚á€áŸ‚á–á“áŸ’á›áº"], correct: 1 },
  { id: 17, question: "áá¾ Histogram á”á„áŸ’á á¶á‰á¢áŸ’áœá¸?", options: ["á‘áŸ†á áŸ†ášá¼á”á—á¶á–", "á€áŸ’ášá¶á áŸ’áœá·á€á“áŸƒá–á“áŸ’á›áºá“á·á„á–ááŸŒá€áŸ’á“á»á„ášá¼á”", "áˆáŸ’á˜áŸ„áŸ‡á€á¶á˜áŸášáŸ‰á¶", "á‘á¸áá¶áŸ†á„ááášá¼á”"], correct: 1 },
  { id: 18, question: "áá¾ Clarity á’áŸ’áœá¾á¢áŸ’áœá¸?", options: ["á”á“áŸ’ááŸ‚á˜ Contrast á“áŸ…ááŸ†á”á“áŸ‹ Midtones", "á’áŸ’áœá¾á±áŸ’á™ášá¼á”á–áŸ’ášá¶á›", "á”áŸ’áá¼ášá–ááŸŒ", "á€áŸ‚á–á“áŸ’á›áºá˜áŸáƒ"], correct: 0 },
  { id: 19, question: "áá¾á‚á½ášá”áŸ’ášá¾á¢áŸ’áœá¸áŠá¾á˜áŸ’á”á¸á€á¶ááŸ‹á”á“áŸ’áá™ Noise?", options: ["Sharpening", "Noise Reduction", "Grain", "Clarity"], correct: 1 },
  { id: 20, question: "áá¾á¢áŸ’áœá¸á‘áŸ…á‡á¶ Chromatic Aberration?", options: ["á–ááŸŒáŸáŸ’á¢á¶á", "áŸáŸ’á“á¶á˜á–ááŸŒáŸáŸ’áœá¶á™/á”áŸƒáá„á“áŸ…áá¶á˜á‚áŸ‚á˜áœááŸ’áá»", "á–á“áŸ’á›áºá…á¶áŸ†á„", "á”áŸ’ášá—áŸá‘ Lens"], correct: 1 }
];

const lessonsData = [
  {
    id: 'light',
    title: 'á–á“áŸ’á›áº (Light)',
    icon: <Sun className="w-5 h-5 text-amber-400" />,
    description: 'ášáŸ€á“á¢áŸ†á–á¸á€á¶ášá€áŸ‚áŸá˜áŸ’ášá½á›á–á“áŸ’á›áºá“áŸ…á€áŸ’á“á»á„ášá¼á”á—á¶á–ášá”áŸáŸ‹á¢áŸ’á“á€áŸ”',
    content: [
      { tool: 'Exposure', khmer: 'á€á¶ášá”áŸ‰áŸ‡á–á“áŸ’á›áº', desc: 'á€áŸ†áááŸ‹á–á“áŸ’á›áºášá½á˜á“áŸƒášá¼á”á—á¶á–á‘á¶áŸ†á„á˜á¼á›áŸ” á”á„áŸ’á€á¾á“ (+) áŠá¾á˜áŸ’á”á¸á±áŸ’á™á—áŸ’á›áº á“á·á„á”á“áŸ’áá™ (-) áŠá¾á˜áŸ’á”á¸á±áŸ’á™á„á„á¹ááŸ”', tip: 'á€áŸ‚áœá¶á˜á»á“á‚áŸá”á„áŸ’á¢áŸáŸ‹áŸ”' },
      { tool: 'Contrast', khmer: 'á—á¶á–á•áŸ’á‘á»á™', desc: 'á€áŸ†áááŸ‹á—á¶á–áá»áŸá‚áŸ’á“á¶ášáœá¶á„á•áŸ’á“áŸ‚á€á—áŸ’á›áº á“á·á„á•áŸ’á“áŸ‚á€á„á„á¹ááŸ” Contrast ááŸ’á–áŸáŸ‹á’áŸ’áœá¾á±áŸ’á™ášá¼á”áŠá·áá…áŸ’á”á¶áŸáŸ‹ á“á·á„á˜á¶á“á‡á˜áŸ’ášáŸ…áŸ”', tip: 'á€á»áŸ†áŠá¶á€áŸ‹ááŸ’á›á¶áŸ†á„á–áŸá€á›á¾áŸ +40áŸ”' },
      { tool: 'Highlights', khmer: 'á•áŸ’á“áŸ‚á€á—áŸ’á›áº', desc: 'á‚áŸ’ášá”áŸ‹á‚áŸ’ášá„ááŸ‚ááŸ†á”á“áŸ‹áŠáŸ‚á›á˜á¶á“á–á“áŸ’á›áºááŸ’á›á¶áŸ†á„á”áŸ†á•á»ááŸ” á”á“áŸ’áá™áœá¶á‡á½á™áŸá„áŸ’á‚áŸ’ášáŸ„áŸ‡á–áŸááŸŒá˜á¶á“áŠáŸ‚á›á”á¶ááŸ‹áŠáŸ„á™áŸá¶ášá–á“áŸ’á›áºá…á¶áŸ†á„áŸ”', tip: 'á”á“áŸ’áá™ (-50) áŠá¾á˜áŸ’á”á¸áŸá„áŸ’á‚áŸ’ášáŸ„áŸ‡á–á“áŸ’á›áºá˜áŸáƒáŸ”' },
      { tool: 'Shadows', khmer: 'á•áŸ’á“áŸ‚á€á„á„á¹á', desc: 'á‚áŸ’ášá”áŸ‹á‚áŸ’ášá„ááŸ‚ááŸ†á”á“áŸ‹áŠáŸ‚á›á˜á¶á“áŸáŸ’ášá˜áŸ„á›áŸ” á€á¶ášáá˜áŸ’á›á¾á„áœá¶á‡á½á™á±áŸ’á™áƒá¾á‰á–áŸááŸŒá˜á¶á“á€áŸ’á“á»á„á€á“áŸ’á›áŸ‚á„á„á„á¹ááŸ”', tip: 'áá˜áŸ’á›á¾á„ (+40) áŸá˜áŸ’ášá¶á”áŸ‹ášá¼á”ááá”á‰áŸ’á…áŸ’ášá¶áŸááŸ’á„áŸƒáŸ”' },
      { tool: 'Whites', khmer: 'á–ááŸŒáŸ', desc: 'á€áŸ†áááŸ‹á…áŸ†áá»á…á–ááŸŒáŸáŠá¶á…áŸ‹áá¶ááŸ” á”á„áŸ’á€á¾á“áœá¶áŠá¾á˜áŸ’á”á¸á±áŸ’á™á•áŸ’á“áŸ‚á€á—áŸ’á›áºá”áŸ†á•á»á á€áŸ’á›á¶á™á‡á¶á–ááŸŒáŸáŸá»á‘áŸ’á’áŸ”', tip: 'áá˜áŸ’á›á¾á„á”á“áŸ’áá·á… (+15) áŠá¾á˜áŸ’á”á¸á±áŸ’á™ášá¼á”á—áŸ’á›áºááŸ’á›á¶áŸ”' },
      { tool: 'Blacks', khmer: 'á–ááŸŒááŸ’á˜áŸ…', desc: 'á€áŸ†áááŸ‹á…áŸ†áá»á…á–ááŸŒááŸ’á˜áŸ…áŠá¶á…áŸ‹áá¶ááŸ” á”á“áŸ’áá™áœá¶áŠá¾á˜áŸ’á”á¸á±áŸ’á™á•áŸ’á“áŸ‚á€á„á„á¹áá”áŸ†á•á»á á€áŸ’á›á¶á™á‡á¶á–ááŸŒááŸ’á˜áŸ…áŸá»á‘áŸ’á’áŸ”', tip: 'á”á“áŸ’áá™á”á“áŸ’áá·á… (-15) áŠá¾á˜áŸ’á”á¸á±áŸ’á™ášá¼á”á˜á¶á“á‡á˜áŸ’ášáŸ…áŸ”' },
    ]
  },
  {
    id: 'color',
    title: 'á–ááŸŒ (Color)',
    icon: <Droplet className="w-5 h-5 text-cyan-400" />,
    description: 'á’áŸ’áœá¾á±áŸ’á™á–ááŸŒá˜á¶á“á—á¶á–ášáŸáŸ‹ášáœá¾á€á“á·á„á€áŸ‚áŸá˜áŸ’ášá½á›áŸá¸áá»ááŸ’á á—á¶á–áŸ”',
    content: [
      { tool: 'Temp', khmer: 'áŸá¸áá»ááŸ’á á—á¶á–', desc: 'á€áŸ†áááŸ‹áŸá¸áá»ááŸ’á á—á¶á–á–ááŸŒáŸ– á›á¿á„ (Warm) á¬ááŸ€áœ (Cool)áŸ”', tip: 'ááá–áŸá›ááŸ’á„áŸƒá›á·á… áá˜áŸ’á›á¾á„á‘áŸ…á›á¿á„áŸ”' },
      { tool: 'Tint', khmer: 'á–ááŸŒá›á¶áŸ†', desc: 'á€áŸ‚áá˜áŸ’ášá¼áœá–ááŸŒá›á¶áŸ†ášáœá¶á„ á”áŸƒáá„ á“á·á„ áŸáŸ’áœá¶á™ (Magenta)áŸ”', tip: 'á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á€áŸ‚á–ááŸŒáŸáŸ’á”áŸ‚á€áŠáŸ‚á›á‡á¶á”áŸ‹á”áŸƒáá„áŸ”' },
      { tool: 'Vibrance', khmer: 'á—á¶á–ášáŸáŸ‹ášáœá¾á€', desc: 'á”á„áŸ’á€á¾á“á–ááŸŒáŠáŸ‚á›áŸáŸ’á›áŸá€ áŠáŸ„á™á˜á·á“á’áŸ’áœá¾á±áŸ’á™á–ááŸŒáŸáŸ’á”áŸ‚á€áá¼á…á¡á¾á™áŸ”', tip: 'á”áŸ’ášá¾á‡áŸ†á“á½áŸ Saturation áŸá˜áŸ’ášá¶á”áŸ‹ášá¼á”á˜á“á»áŸáŸ’áŸáŸ”' },
      { tool: 'Saturation', khmer: 'á€á˜áŸ’ášá·áá–ááŸŒ', desc: 'á”á„áŸ’á€á¾á“á—á¶á–áŠá·áá“áŸƒá–ááŸŒá‘á¶áŸ†á„á¢áŸáŸ‹áŸáŸ’á˜á¾áŸ—á‚áŸ’á“á¶áŸ”', tip: 'á”áŸ’ášá¾áá·á…áŸ— (-10 á‘áŸ… +10)áŸ”' },
      { tool: 'Color Mix', khmer: 'á€á¶ášá›á¶á™á–ááŸŒ', desc: 'á‚áŸ’ášá”áŸ‹á‚áŸ’ášá„ Hue, Saturation, Luminance á“áŸƒá–ááŸŒá“á¸á˜á½á™áŸ—áŸ”', tip: 'Orange: áá˜áŸ’á›á¾á„ Luminance áŠá¾á˜áŸ’á”á¸á±áŸ’á™áŸáŸ’á”áŸ‚á€áŸáŸ”' },
      { tool: 'Color Grading', khmer: 'á€á¶ášáŠá¶á€áŸ‹á–ááŸŒ', desc: 'áŠá¶á€áŸ‹á–ááŸŒá…á¼á›á‘áŸ…á€áŸ’á“á»á„ Shadows, Midtones, á“á·á„ HighlightsáŸ”', tip: 'Teal Shadows, Orange Highlights (Cinematic)áŸ”' },
    ]
  },
  {
    id: 'effects',
    title: 'á”áŸ‚á”á•áŸ‚á“ (Effects)',
    icon: <Aperture className="w-5 h-5 text-purple-400" />,
    description: 'á”á“áŸ’ááŸ‚á˜á—á¶á–á…áŸ’á”á¶áŸáŸ‹ á“á·á„áœá¶á™á“á—á¶á–á‘áŸ…á€á¶á“áŸ‹ášá¼á”á—á¶á–áŸ”',
    content: [
      { tool: 'Texture', khmer: 'áœá¶á™á“á—á¶á–', desc: 'á’áŸ’áœá¾á±áŸ’á™á•áŸ’á‘áŸƒášá”áŸáŸ‹áœááŸ’áá» (áŸáŸ’á”áŸ‚á€, ááŸ’á˜) á€á¶á“áŸ‹ááŸ‚á›áŸá…á’áŸ’á›áŸ„áŸ”', tip: 'á”á“áŸ’áá™ (-20) áŠá¾á˜áŸ’á”á¸á’áŸ’áœá¾á±áŸ’á™áŸáŸ’á”áŸ‚á€á˜á»áá˜áŸ‰ááŸ‹áŸ”' },
      { tool: 'Clarity', khmer: 'á—á¶á–á…áŸ’á”á¶áŸáŸ‹', desc: 'á”á“áŸ’ááŸ‚á˜ Contrast á“áŸ…ááŸ†á”á“áŸ‹á€ááŸ’áá¶á› á’áŸ’áœá¾á±áŸ’á™ášá¼á”á˜á¾á›á‘áŸ…á˜á¶á“á‡á˜áŸ’ášáŸ…áŸ”', tip: 'á€á»áŸ†á”áŸ’ášá¾á›á¾á˜á»áá˜á“á»áŸáŸ’áŸáŸáŸ’ááŸ’ášá¸ á¬á€á»á˜á¶ášáŸ”' },
      { tool: 'Dehaze', khmer: 'á€á¶ááŸ‹á”á“áŸ’áá™á¢áŸá–áŸ’á‘', desc: 'á›á»á”á¢áŸá–áŸ’á‘ á¬á•áŸ’áŸáŸ‚á„áŸ”', tip: 'áá˜áŸ’á›á¾á„á”á“áŸ’áá·á… (+15) áŸá˜áŸ’ášá¶á”áŸ‹ášá¼á”ááá˜áŸáƒáŸ”' },
      { tool: 'Vignette', khmer: 'á‚áŸ‚á˜á„á„á¹á', desc: 'á’áŸ’áœá¾á±áŸ’á™á‚áŸ‚á˜ášá¼á”á—á¶á–á„á„á¹á áŠá¾á˜áŸ’á”á¸ášá»á‰á…áŸ†áá¶á”áŸ‹á¢á¶ášá˜áŸ’á˜ááŸá‘áŸ…á€ááŸ’áá¶á›áŸ”', tip: 'áŠá¶á€áŸ‹á€á˜áŸ’ášá·á -15 á‘áŸ… -20áŸ”' },
    ]
  },
  {
    id: 'detail',
    title: 'á—á¶á–á›á˜áŸ’á¢á·á (Detail)',
    icon: <Triangle className="w-5 h-5 text-pink-400" />,
    description: 'á‚áŸ’ášá”áŸ‹á‚áŸ’ášá„á—á¶á–á…áŸ’á”á¶áŸáŸ‹ á“á·á„á€á¶ááŸ‹á”á“áŸ’áá™á‚áŸ’ášá¶á”áŸ‹ (Noise)áŸ”',
    content: [
      { tool: 'Sharpening', khmer: 'á€á¶ášá’áŸ’áœá¾á±áŸ’á™á…áŸ’á”á¶áŸáŸ‹', desc: 'á’áŸ’áœá¾á±áŸ’á™á‚áŸ‚á˜á“áŸƒáœááŸ’áá»á€áŸ’á“á»á„ášá¼á”á—á¶á–á€á¶á“áŸ‹ááŸ‚á˜á»ááŸ”', tip: 'á”áŸ’ášá¾ Masking (2 fingers) áŠá¾á˜áŸ’á”á¸á€á»áŸ†á±áŸ’á™á”áŸ‰áŸ‡á–á¶á›áŸ‹áŸáŸ’á”áŸ‚á€áŸ”' },
      { tool: 'Noise Reduction', khmer: 'á€á¶ááŸ‹á”á“áŸ’áá™á‚áŸ’ášá¶á”áŸ‹', desc: 'á›á»á”á‚áŸ’ášá¶á”áŸ‹ (Noise) áŠáŸ‚á›á€á¾áá¡á¾á„áŠáŸ„á™áŸá¶áš ISO ááŸ’á–áŸáŸ‹áŸ”', tip: 'á€á»áŸ†áŠá¶á€áŸ‹ááŸ’á›á¶áŸ†á„á–áŸá€ á”áŸ’ášá™áŸááŸ’á“ášá¼á”á”á¶ááŸ‹ DetailáŸ”' },
      { tool: 'Color Noise', khmer: 'á‚áŸ’ášá¶á”áŸ‹á–ááŸŒ', desc: 'á›á»á”á‚áŸ’ášá¶á”áŸ‹á–ááŸŒáá»áŸá”áŸ’ášá€áŸ’ášáá¸ (áŸáŸ’á»á…áŸ—á–ááŸŒáŸáŸ’áœá¶á™/á”áŸƒáá„)áŸ”', tip: 'á‘á»á€á“áŸ…áá˜áŸ’á›áŸƒ 25 (Default)áŸ”' },
    ]
  },
  {
    id: 'masking',
    title: 'á€á¶ášá€áŸ‚ááŸ†á”á“áŸ‹ (Masking)',
    icon: <ScanFace className="w-5 h-5 text-green-400" />,
    description: 'á€áŸ‚áá˜áŸ’ášá¼áœááŸ‚á•áŸ’á“áŸ‚á€ááŸ’á›áŸ‡á“áŸƒášá¼á”á—á¶á– (á˜áŸáƒ, á˜á“á»áŸáŸ’áŸ)áŸ”',
    content: [
      { tool: 'Select Subject', khmer: 'á‡áŸ’ášá¾áŸášá¾áŸáœááŸ’áá»', desc: 'AI á“á¹á„á‡áŸ’ášá¾áŸášá¾áŸá˜á“á»áŸáŸ’áŸ á¬áœááŸ’áá»áŸáŸ†áá¶á“áŸ‹áŸ”', tip: 'á’áŸ’áœá¾á±áŸ’á™á˜á“á»áŸáŸ’áŸá—áŸ’á›áºá‡á¶á„ BackgroundáŸ”' },
      { tool: 'Select Sky', khmer: 'á‡áŸ’ášá¾áŸášá¾áŸá˜áŸáƒ', desc: 'AI á‡áŸ’ášá¾áŸášá¾áŸá•áŸ’á‘áŸƒá˜áŸáƒá‘á¶áŸ†á„á¢áŸáŸ‹áŸ”', tip: 'á”á“áŸ’áá™ Highlights áŠá¾á˜áŸ’á”á¸á”á¶á“á˜áŸáƒá–ááŸŒááŸ€áœáŠá·ááŸ”' },
      { tool: 'Linear Gradient', khmer: 'áŠáŸá‰á–ááŸŒ', desc: 'á€áŸ‚ááŸ†á”á“áŸ‹á‡á¶á›á€áŸ’áááŸˆá”á“áŸ’á‘á¶ááŸ‹áŸ”', tip: 'á’áŸ’áœá¾á±áŸ’á™áŠá¸á—áŸ’á›áº á¬á˜áŸáƒá„á„á¹ááŸ”' },
      { tool: 'Radial Gradient', khmer: 'ášá„áŸ’áœá„áŸ‹', desc: 'á€áŸ‚ááŸ†á”á“áŸ‹á‡á¶ášá„áŸ’áœá„áŸ‹áŸ”', tip: 'á”áŸ’ášá¾á”á„áŸ’á€á¾áá–á“áŸ’á›áºáŸá·á”áŸ’á”á“á·á˜áŸ’á˜á·á á¬ SpotlightáŸ”' },
    ]
  },
  {
    id: 'optics',
    title: 'Optics & Geometry',
    icon: <Crop className="w-5 h-5 text-cyan-400" />,
    description: 'á€áŸ‚á‘á˜áŸ’ášá„áŸ‹ášá¼á”á—á¶á– á“á·á„á€áŸ‚áœáááŸ”',
    content: [
      { tool: 'Lens Corrections', khmer: 'á€áŸ‚á€áŸ‚áœáá', desc: 'á€áŸ‚á€á¶ášá–á“áŸ’á›á™ (Distortion) á“á·á„ Vignette ášá”áŸáŸ‹á€áŸ‚áœáááŸ”', tip: 'á”á¾á€áœá¶á‡á¶á“á·á…áŸ’á…áŸ”' },
      { tool: 'Chromatic Aberration', khmer: 'á–ááŸŒáá¶á˜á‚áŸ‚á˜', desc: 'á›á»á”áŸáŸ’á“á¶á˜á–ááŸŒáŸáŸ’áœá¶á™/á”áŸƒáá„ á“áŸ…áá¶á˜á‚áŸ‚á˜áœááŸ’áá»áŸ”', tip: 'á…á¶áŸ†á”á¶á…áŸ‹áŸá˜áŸ’ášá¶á”áŸ‹ášá¼á”áááŠáŸ‚á›á˜á¶á“ Contrast ááŸ’á–áŸáŸ‹áŸ”' },
      { tool: 'Upright', khmer: 'áá˜áŸ’ášá„áŸ‹ášá¼á”', desc: 'á’áŸ’áœá¾á±áŸ’á™á¢á‚á¶áš á¬á”á“áŸ’á‘á¶ááŸ‹á€áŸ’á“á»á„ášá¼á”ááŸ’ášá„áŸ‹áŠáŸ„á™áŸáŸ’áœáŸá™á”áŸ’ášáœááŸ’áá·áŸ”', tip: 'á”áŸ’ášá¾ "Auto" áŸá˜áŸ’ášá¶á”áŸ‹á›á‘áŸ’á’á•á›ášá áŸáŸáŸ”' },
    ]
  },
  {
    id: 'export',
    title: 'ášá€áŸ’áŸá¶á‘á»á€ (Export)',
    icon: <Save className="w-5 h-5 text-indigo-500" />,
    description: 'ášá”áŸ€á”ášá€áŸ’áŸá¶á‘á»á€ášá¼á”á—á¶á–á±áŸ’á™á˜á¶á“á‚á»áá—á¶á–ááŸ’á–áŸáŸ‹áŸ”',
    content: [
      { tool: 'JPG', khmer: 'ášá¼á”á—á¶á–á’á˜áŸ’á˜áá¶', desc: 'á¯á€áŸá¶ášášá¼á”á—á¶á–áŠáŸ‚á›ááŸ’ášá¼áœá”á¶á“á”á„áŸ’ášá½á˜áŸ”', tip: 'á›áŸ’á¢áŸá˜áŸ’ášá¶á”áŸ‹á”á„áŸ’á áŸ„áŸ‡á›á¾á”ááŸ’áá¶á‰áŸá„áŸ’á‚á˜áŸ”' },
      { tool: 'DNG', khmer: 'á¯á€áŸá¶áš RAW', desc: 'á¯á€áŸá¶ášáŠá¾á˜áŠáŸ‚á›á¢á¶á…á€áŸ‚á–ááŸŒá”á“áŸ’áá”á¶á“á›áŸ’á¢áŸ”', tip: 'á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹ášá€áŸ’áŸá¶á‘á»á€ Preset áŠá¾á˜áŸ’á”á¸á…áŸ‚á€ášáŸ†á›áŸ‚á€áŸ”' },
      { tool: 'Watermark', khmer: 'áˆáŸ’á˜áŸ„áŸ‡á›á¾ášá¼á”', desc: 'áŠá¶á€áŸ‹áˆáŸ’á˜áŸ„áŸ‡ á¬ Logo ášá”áŸáŸ‹á¢áŸ’á“á€á›á¾ášá¼á”á—á¶á–áŸ”', tip: 'á€á¶ášá–á¶ášá€á˜áŸ’á˜áŸá·á‘áŸ’á’á·á”á‰áŸ’á‰á¶áŸ”' },
    ]
  }
];

// ğŸ”¥ NEW: 15+ Preset Database (No API required)
const PRESET_DB = {
    "teal & orange": {
        basic: { Exposure: 0.10, Contrast: 20, Highlights: -40, Shadows: 30, Whites: 15, Blacks: -20, Temp: 5, Tint: -5, Vibrance: 25, Saturation: -10, Clarity: 10, Dehaze: 5, Vignette: -15 },
        detail: { Sharpening: 40, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "S-Curve" },
        colorMix: [
            { color: "Red", h: 0, s: 0, l: 0 }, { color: "Orange", h: -10, s: 15, l: 5 }, { color: "Yellow", h: -30, s: -20, l: 0 },
            { color: "Green", h: -60, s: -40, l: -10 }, { color: "Aqua", h: -50, s: 10, l: -10 }, { color: "Blue", h: -50, s: 10, l: -10 }, { color: "Purple", h: 0, s: -40, l: 0 }, { color: "Magenta", h: 0, s: -40, l: 0 }
        ],
        grading: { Shadows: { h: 210, s: 20, l: -5 }, Midtones: { h: 30, s: 10, l: 0 }, Highlights: { h: 35, s: 20, l: 0 }, Blending: 50, Balance: 0 }
    },
    "dark moody": {
        basic: { Exposure: -0.15, Contrast: 30, Highlights: -60, Shadows: -10, Whites: -30, Blacks: -10, Temp: -5, Tint: 0, Vibrance: -10, Saturation: -25, Clarity: 15, Dehaze: 10, Vignette: -30 },
        detail: { Sharpening: 35, Noise: 0, ColorNoise: 25 },
        effects: { Grain: 10 },
        curve: { RGB: "Matte" },
        colorMix: [
            { color: "Red", h: 0, s: -20, l: -10 }, { color: "Orange", h: 0, s: -10, l: 0 }, { color: "Yellow", h: -100, s: -50, l: 0 },
            { color: "Green", h: -100, s: -60, l: -30 }, { color: "Aqua", h: 0, s: -50, l: 0 }, { color: "Blue", h: 0, s: -50, l: -20 }, { color: "Purple", h: 0, s: -50, l: 0 }, { color: "Magenta", h: 0, s: -50, l: 0 }
        ],
        grading: { Shadows: { h: 220, s: 15, l: -10 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 40, s: 5, l: 0 }, Blending: 50, Balance: 0 }
    },
    "bright & airy": {
        basic: { Exposure: 0.50, Contrast: 10, Highlights: -30, Shadows: 60, Whites: 40, Blacks: 20, Temp: 5, Tint: 5, Vibrance: 30, Saturation: 5, Clarity: -10, Dehaze: 0, Vignette: 0 },
        detail: { Sharpening: 25, Noise: 20, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "Linear" },
        colorMix: [
            { color: "Red", h: 10, s: 10, l: 5 }, { color: "Orange", h: 5, s: 10, l: 15 }, { color: "Yellow", h: 10, s: 15, l: 10 },
            { color: "Green", h: 30, s: 20, l: 20 }, { color: "Aqua", h: 0, s: 15, l: 10 }, { color: "Blue", h: 0, s: 15, l: 10 }, { color: "Purple", h: 0, s: 0, l: 0 }, { color: "Magenta", h: 0, s: 0, l: 0 }
        ],
        grading: { Shadows: { h: 0, s: 0, l: 0 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 50, s: 10, l: 5 }, Blending: 50, Balance: 0 }
    },
    "vintage film": {
        basic: { Exposure: 0.10, Contrast: 10, Highlights: -20, Shadows: 20, Whites: -20, Blacks: 30, Temp: 10, Tint: 0, Vibrance: -10, Saturation: -15, Clarity: 0, Dehaze: -5, Vignette: -20 },
        detail: { Sharpening: 20, Noise: 0, ColorNoise: 25 },
        effects: { Grain: 40 },
        curve: { RGB: "Faded" },
        colorMix: [
             { color: "Red", h: 0, s: -10, l: 0 }, { color: "Orange", h: 0, s: -5, l: 0 }, { color: "Yellow", h: -20, s: -30, l: 0 },
             { color: "Green", h: -40, s: -40, l: 0 }, { color: "Aqua", h: 0, s: -30, l: 0 }, { color: "Blue", h: -10, s: -30, l: 0 }, { color: "Purple", h: 0, s: -40, l: 0 }, { color: "Magenta", h: 0, s: -40, l: 0 }
        ],
        grading: { Shadows: { h: 40, s: 15, l: 0 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 200, s: 10, l: 0 }, Blending: 50, Balance: 0 }
    },
    "cyberpunk": {
        basic: { Exposure: 0.20, Contrast: 20, Highlights: 10, Shadows: 10, Whites: 20, Blacks: -10, Temp: -20, Tint: 30, Vibrance: 50, Saturation: 10, Clarity: 20, Dehaze: 15, Vignette: -10 },
        detail: { Sharpening: 50, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "High Contrast" },
        colorMix: [
             { color: "Red", h: 20, s: 30, l: 0 }, { color: "Orange", h: 0, s: 10, l: 5 }, { color: "Yellow", h: -100, s: 0, l: 0 },
             { color: "Green", h: 100, s: -50, l: 0 }, { color: "Aqua", h: -30, s: 50, l: 0 }, { color: "Blue", h: -30, s: 50, l: 0 }, { color: "Purple", h: 50, s: 40, l: 0 }, { color: "Magenta", h: 50, s: 40, l: 0 }
        ],
        grading: { Shadows: { h: 260, s: 40, l: -5 }, Midtones: { h: 300, s: 20, l: 0 }, Highlights: { h: 320, s: 30, l: 0 }, Blending: 50, Balance: 0 }
    },
    "golden hour": {
        basic: { Exposure: 0.15, Contrast: 15, Highlights: -30, Shadows: 30, Whites: 10, Blacks: -10, Temp: 20, Tint: 10, Vibrance: 30, Saturation: 10, Clarity: 10, Dehaze: 0, Vignette: -10 },
        detail: { Sharpening: 35, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "S-Curve" },
        colorMix: [
            { color: "Red", h: 10, s: 10, l: 0 }, { color: "Orange", h: -5, s: 20, l: 10 }, { color: "Yellow", h: -15, s: 25, l: 5 },
            { color: "Green", h: -20, s: 10, l: 0 }, { color: "Aqua", h: 0, s: 0, l: 0 }, { color: "Blue", h: 0, s: 10, l: 0 }, { color: "Purple", h: 0, s: 0, l: 0 }, { color: "Magenta", h: 0, s: 0, l: 0 }
        ],
        grading: { Shadows: { h: 40, s: 20, l: 0 }, Midtones: { h: 35, s: 10, l: 0 }, Highlights: { h: 45, s: 30, l: 5 }, Blending: 50, Balance: 0 }
    },
    "soft pastel": {
        basic: { Exposure: 0.30, Contrast: -15, Highlights: -40, Shadows: 50, Whites: 20, Blacks: 30, Temp: 0, Tint: 10, Vibrance: 35, Saturation: -10, Clarity: -15, Dehaze: -5, Vignette: 0 },
        detail: { Sharpening: 20, Noise: 20, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "Matte" },
        colorMix: [
             { color: "Red", h: 15, s: 10, l: 10 }, { color: "Orange", h: 10, s: 10, l: 15 }, { color: "Yellow", h: -5, s: 15, l: 10 },
             { color: "Green", h: 40, s: 10, l: 10 }, { color: "Aqua", h: -10, s: 20, l: 15 }, { color: "Blue", h: -10, s: 20, l: 15 }, { color: "Purple", h: 20, s: 10, l: 5 }, { color: "Magenta", h: 20, s: 10, l: 5 }
        ],
        grading: { Shadows: { h: 220, s: 10, l: 5 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 40, s: 10, l: 5 }, Blending: 50, Balance: 0 }
    },
    "urban grey": {
        basic: { Exposure: 0.05, Contrast: 30, Highlights: -40, Shadows: 25, Whites: 25, Blacks: -30, Temp: -5, Tint: 0, Vibrance: -25, Saturation: -40, Clarity: 30, Dehaze: 10, Vignette: -20 },
        detail: { Sharpening: 50, Noise: 0, ColorNoise: 25 },
        effects: { Grain: 25 },
        curve: { RGB: "High Contrast" },
        colorMix: [
             { color: "Red", h: 0, s: -30, l: -10 }, { color: "Orange", h: 0, s: 10, l: 0 }, { color: "Yellow", h: -100, s: -100, l: 0 },
             { color: "Green", h: -100, s: -100, l: 0 }, { color: "Aqua", h: -100, s: -100, l: -10 }, { color: "Blue", h: -100, s: -100, l: -10 }, { color: "Purple", h: -100, s: -100, l: 0 }, { color: "Magenta", h: -100, s: -100, l: 0 }
        ],
        grading: { Shadows: { h: 210, s: 15, l: -10 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 0, s: 0, l: 0 }, Blending: 50, Balance: 0 }
    },
    "black & white": {
        basic: { Exposure: 0.0, Contrast: 40, Highlights: -20, Shadows: 20, Whites: 30, Blacks: -30, Temp: 0, Tint: 0, Vibrance: 0, Saturation: -100, Clarity: 25, Dehaze: 10, Vignette: -15 },
        detail: { Sharpening: 45, Noise: 15, ColorNoise: 0 },
        effects: { Grain: 30 },
        curve: { RGB: "S-Curve" },
        colorMix: [
            { color: "Red", h: 0, s: 0, l: -15 }, { color: "Orange", h: 0, s: 0, l: -5 }, { color: "Yellow", h: 0, s: 0, l: 15 },
            { color: "Green", h: 0, s: 0, l: -10 }, { color: "Aqua", h: 0, s: 0, l: -25 }, { color: "Blue", h: 0, s: 0, l: -30 }, { color: "Purple", h: 0, s: 0, l: 0 }, { color: "Magenta", h: 0, s: 0, l: 0 }
        ],
        grading: { Shadows: { h: 0, s: 0, l: 0 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 0, s: 0, l: 0 }, Blending: 50, Balance: 0 }
    },
    "hdr landscape": {
        basic: { Exposure: 0.0, Contrast: 15, Highlights: -90, Shadows: 90, Whites: 30, Blacks: -30, Temp: 5, Tint: 5, Vibrance: 45, Saturation: 15, Clarity: 35, Dehaze: 25, Vignette: -10 },
        detail: { Sharpening: 65, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "Linear" },
        colorMix: [
            { color: "Red", h: 0, s: 15, l: 0 }, { color: "Orange", h: 0, s: 15, l: 0 }, { color: "Yellow", h: 0, s: 20, l: 0 },
            { color: "Green", h: 15, s: 25, l: -10 }, { color: "Aqua", h: -10, s: 35, l: -15 }, { color: "Blue", h: -10, s: 35, l: -15 }, { color: "Purple", h: 0, s: 0, l: 0 }, { color: "Magenta", h: 0, s: 0, l: 0 }
        ],
        grading: { Shadows: { h: 0, s: 0, l: 0 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 50, s: 15, l: 0 }, Blending: 50, Balance: 0 }
    },
    "matte black": {
        basic: { Exposure: 0.05, Contrast: 10, Highlights: -30, Shadows: 40, Whites: -10, Blacks: 20, Temp: 0, Tint: 0, Vibrance: -10, Saturation: -20, Clarity: 10, Dehaze: 0, Vignette: -15 },
        detail: { Sharpening: 25, Noise: 0, ColorNoise: 25 },
        effects: { Grain: 15 },
        curve: { RGB: "Matte" }, // Important: Lifted blacks
        colorMix: [
            { color: "Red", h: 0, s: -10, l: 0 }, { color: "Orange", h: 0, s: -5, l: 0 }, { color: "Yellow", h: 0, s: -20, l: 0 },
            { color: "Green", h: 0, s: -30, l: -10 }, { color: "Aqua", h: 0, s: -30, l: 0 }, { color: "Blue", h: 0, s: -30, l: -10 }, { color: "Purple", h: 0, s: -30, l: 0 }, { color: "Magenta", h: 0, s: -30, l: 0 }
        ],
        grading: { Shadows: { h: 0, s: 0, l: 0 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 0, s: 0, l: 0 }, Blending: 50, Balance: 0 }
    },
    "warm coffee": {
        basic: { Exposure: 0.10, Contrast: 15, Highlights: -40, Shadows: 25, Whites: 10, Blacks: -10, Temp: 15, Tint: 5, Vibrance: 10, Saturation: -15, Clarity: 10, Dehaze: 5, Vignette: -15 },
        detail: { Sharpening: 30, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 20 },
        curve: { RGB: "S-Curve" },
        colorMix: [
            { color: "Red", h: 10, s: 0, l: -5 }, { color: "Orange", h: 5, s: 10, l: 0 }, { color: "Yellow", h: -10, s: -10, l: 5 },
            { color: "Green", h: -20, s: -40, l: 0 }, { color: "Aqua", h: 0, s: -50, l: 0 }, { color: "Blue", h: -10, s: -50, l: -10 }, { color: "Purple", h: 0, s: -50, l: 0 }, { color: "Magenta", h: 0, s: -50, l: 0 }
        ],
        grading: { Shadows: { h: 30, s: 20, l: 0 }, Midtones: { h: 35, s: 10, l: 0 }, Highlights: { h: 40, s: 15, l: 5 }, Blending: 50, Balance: 0 }
    },
    "cool blue": {
        basic: { Exposure: 0.10, Contrast: 20, Highlights: -30, Shadows: 20, Whites: 20, Blacks: -10, Temp: -15, Tint: 0, Vibrance: 20, Saturation: 0, Clarity: 15, Dehaze: 10, Vignette: -10 },
        detail: { Sharpening: 40, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "S-Curve" },
        colorMix: [
            { color: "Red", h: 0, s: 0, l: 0 }, { color: "Orange", h: 0, s: 10, l: 5 }, { color: "Yellow", h: 0, s: 0, l: 0 },
            { color: "Green", h: 20, s: 10, l: 0 }, { color: "Aqua", h: 10, s: 20, l: 0 }, { color: "Blue", h: 0, s: 30, l: 5 }, { color: "Purple", h: 0, s: 0, l: 0 }, { color: "Magenta", h: 0, s: 0, l: 0 }
        ],
        grading: { Shadows: { h: 210, s: 25, l: -5 }, Midtones: { h: 220, s: 10, l: 0 }, Highlights: { h: 200, s: 15, l: 0 }, Blending: 50, Balance: 0 }
    },
    "desaturated brown": {
        basic: { Exposure: 0.0, Contrast: 10, Highlights: -50, Shadows: 40, Whites: 10, Blacks: 10, Temp: 10, Tint: 0, Vibrance: -20, Saturation: -30, Clarity: 10, Dehaze: 0, Vignette: -10 },
        detail: { Sharpening: 30, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 15 },
        curve: { RGB: "Faded" },
        colorMix: [
            { color: "Red", h: 10, s: -20, l: -10 }, { color: "Orange", h: 5, s: -10, l: 0 }, { color: "Yellow", h: -15, s: -40, l: 5 },
            { color: "Green", h: -30, s: -60, l: -10 }, { color: "Aqua", h: 0, s: -70, l: 0 }, { color: "Blue", h: 0, s: -70, l: -10 }, { color: "Purple", h: 0, s: -50, l: 0 }, { color: "Magenta", h: 0, s: -50, l: 0 }
        ],
        grading: { Shadows: { h: 30, s: 15, l: 0 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 40, s: 10, l: 5 }, Blending: 50, Balance: 0 }
    },
    "vibrant pop": {
        basic: { Exposure: 0.15, Contrast: 30, Highlights: -40, Shadows: 30, Whites: 20, Blacks: -20, Temp: 5, Tint: 5, Vibrance: 60, Saturation: 10, Clarity: 20, Dehaze: 10, Vignette: -10 },
        detail: { Sharpening: 50, Noise: 10, ColorNoise: 25 },
        effects: { Grain: 0 },
        curve: { RGB: "High Contrast" },
        colorMix: [
            { color: "Red", h: 0, s: 20, l: 5 }, { color: "Orange", h: 0, s: 15, l: 5 }, { color: "Yellow", h: 0, s: 20, l: 5 },
            { color: "Green", h: 10, s: 30, l: 5 }, { color: "Aqua", h: 0, s: 30, l: 5 }, { color: "Blue", h: 0, s: 30, l: 5 }, { color: "Purple", h: 10, s: 20, l: 0 }, { color: "Magenta", h: 10, s: 20, l: 0 }
        ],
        grading: { Shadows: { h: 0, s: 0, l: 0 }, Midtones: { h: 0, s: 0, l: 0 }, Highlights: { h: 0, s: 0, l: 0 }, Blending: 50, Balance: 0 }
    }
};

// --- COMPONENTS ---

const Header = ({ activeTab, setActiveTab }) => {
  const [logoSrc, setLogoSrc] = useState('/logo.svg');
  return (
    <header className="bg-[#0f172a] text-white sticky top-0 z-50 shadow-lg border-b border-gray-800">
      <div className="max-w-5xl mx-auto px-4 py-3 flex justify-between items-center">
        <div className="flex items-center space-x-3 cursor-pointer" onClick={() => setActiveTab('learn')}>
          <div className="w-10 h-10 relative rounded-2xl overflow-hidden shadow-sm bg-white/10 flex-shrink-0">
            {!logoSrc.startsWith('/') && !logoSrc.startsWith('http') ? (
                 <div className="w-full h-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center">
                      <ImageIcon className="w-6 h-6 text-white" />
                 </div>
            ) : (
                <img src={logoSrc} alt="App Logo" className="w-full h-full object-cover" onError={(e) => setLogoSrc('')} />
            )}
          </div>
          <h1 className="text-lg font-bold font-khmer">Lightroom <span className="text-blue-400">á˜áŸ‰á¶á™áŒá¸á áŸ’áŸá¶á‰</span></h1>
        </div>
        <nav className="hidden md:flex space-x-2 bg-[#1e293b] p-1 rounded-full text-sm border border-gray-700">
          <button onClick={() => setActiveTab('learn')} className={`px-4 py-2 rounded-full transition-all flex items-center space-x-2 ${activeTab === 'learn' ? 'bg-[#334155] text-white shadow' : 'text-gray-400 hover:text-white hover:bg-[#334155]'}`}><BookOpen className="w-4 h-4" /> <span className="font-khmer">á˜áŸášáŸ€á“</span></button>
          <button onClick={() => setActiveTab('quiz')} className={`px-4 py-2 rounded-full transition-all flex items-center space-x-2 ${activeTab === 'quiz' ? 'bg-[#334155] text-white shadow' : 'text-gray-400 hover:text-white hover:bg-[#334155]'}`}><Award className="w-4 h-4" /> <span className="font-khmer">ááŸáŸáŸ’á</span></button>
          <button onClick={() => setActiveTab('ai')} className={`px-4 py-2 rounded-full transition-all flex items-center space-x-2 ${activeTab === 'ai' ? 'bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow' : 'text-gray-400 hover:text-white hover:bg-[#334155]'}`}><Sparkles className="w-4 h-4" /> <span className="font-khmer">á‚áŸ’ášá¼ AI</span></button>
        </nav>
      </div>
    </header>
  );
};

const CurveVisualizer = ({ type }) => {
    const getPath = () => {
        const t = (type || "").toLowerCase();
        if (t.includes("s-curve")) return "M 0 100 C 25 100, 25 75, 50 50 C 75 25, 75 0, 100 0";
        if (t.includes("matte")) return "M 0 80 C 25 80, 25 75, 50 50 C 75 25, 75 0, 100 0";
        return "M 0 100 L 100 0";
    };
    return (
        <div className="relative w-full aspect-square bg-[#1e293b] border border-gray-700 rounded-lg overflow-hidden shadow-inner">
            <svg viewBox="0 0 100 100" className="absolute inset-0 w-full h-full opacity-30">
                {[25, 50, 75].map(i => <React.Fragment key={i}><line x1={i} y1="0" x2={i} y2="100" stroke="gray" strokeWidth="0.5" /><line x1="0" y1={i} x2="100" y2={i} stroke="gray" strokeWidth="0.5" /></React.Fragment>)}
            </svg>
            <svg viewBox="0 0 100 100" className="absolute inset-0 w-full h-full p-0" preserveAspectRatio="none">
                <path d={getPath()} stroke="white" strokeWidth="2" fill="none" vectorEffect="non-scaling-stroke" />
            </svg>
        </div>
    );
};

const ColorWheel = ({ h, s, l, label }) => {
  const angle = h; 
  const distance = Math.min(s, 100) / 2; 
  const radians = (angle - 90) * (Math.PI / 180);
  const x = 50 + (distance * Math.cos(radians));
  const y = 50 + (distance * Math.sin(radians));

  return (
    <div className="flex flex-col items-center">
       <div className="relative w-16 h-16 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-600 shadow-inner overflow-hidden mb-1">
          <div className="absolute inset-0 opacity-30 bg-[conic-gradient(red,yellow,lime,cyan,blue,magenta,red)] rounded-full"></div>
          <div className="absolute w-2 h-2 bg-white rounded-full shadow border border-black transform -translate-x-1/2 -translate-y-1/2" style={{ left: `${x}%`, top: `${y}%` }} />
       </div>
       <div className="text-[10px] text-gray-400 font-mono text-center">
          <span className="block font-bold text-gray-300 mb-1">{label}</span>
          H{h} S{s} L{l}
       </div>
    </div>
  );
};

const LessonModal = ({ lesson, onClose }) => {
  useEffect(() => { document.body.style.overflow = 'hidden'; return () => { document.body.style.overflow = 'auto'; }; }, []);
  return (
    <div className="fixed inset-0 z-[100] flex items-end sm:items-center justify-center">
      <div className={`absolute inset-0 bg-black/80 backdrop-blur-sm`} onClick={onClose} />
      <div className={`relative w-full h-[92%] sm:h-[85%] sm:w-[90%] max-w-2xl bg-[#1e293b] rounded-t-2xl sm:rounded-2xl overflow-hidden shadow-2xl flex flex-col`}>
        <div className="bg-[#0f172a] border-b border-gray-800 p-4 flex items-center justify-between sticky top-0 z-10"><h2 className="text-xl font-bold font-khmer text-white">{lesson.title}</h2><button onClick={onClose} className="p-2 bg-white/10 hover:bg-white/20 rounded-full text-gray-300"><X className="w-6 h-6" /></button></div>
        <div className="flex-1 overflow-y-auto p-4 space-y-4 pb-12">{lesson.content.map((item, idx) => (
          <div key={idx} className="bg-[#334155]/50 p-4 rounded-xl border border-gray-700">
            <div className="flex justify-between items-center mb-2 gap-2">
              <span className="font-bold text-lg text-blue-400">{item.tool}</span>
              <span className="text-xs font-bold bg-[#0f172a] text-gray-300 px-2 py-1 rounded font-khmer border border-gray-700 whitespace-nowrap flex-shrink-0">{item.khmer}</span>
            </div>
            <p className="text-gray-200 text-sm font-khmer leading-relaxed">{item.desc}</p>
            {item.tip && <div className="mt-3 pt-3 border-t border-gray-700 flex items-start space-x-2"><span className="text-lg">ğŸ’¡</span><p className="text-yellow-400/90 text-sm font-khmer italic leading-relaxed"><span className="font-bold mr-1">á‚á“áŸ’á›á¹áŸ‡:</span>{item.tip}</p></div>}
          </div>
        ))}</div>
      </div>
    </div>
  );
};

const LessonCard = ({ lesson, onClick }) => (
    <button onClick={onClick} className="bg-[#1e293b] rounded-xl overflow-hidden border border-gray-800 shadow-md transition-all hover:scale-[1.02] active:scale-95 hover:border-blue-500/50 cursor-pointer h-full flex flex-col group w-full text-left hover:shadow-lg hover:shadow-blue-900/20">
      <div className="p-5 flex items-center justify-between w-full">
        <div className="flex items-center gap-4"><div className="bg-[#0f172a] p-3 rounded-xl shadow-inner border border-gray-800 group-hover:bg-[#1e293b] transition-colors">{lesson.icon}</div><div><h3 className="font-bold text-white text-lg font-khmer">{lesson.title}</h3><p className="text-gray-400 text-xs font-khmer mt-0.5 line-clamp-1">{lesson.description}</p></div></div><div className="bg-[#0f172a] p-2 rounded-full text-blue-400 group-hover:bg-blue-600 group-hover:text-white"><ChevronRight className="w-5 h-5" /></div>
      </div>
    </button>
);

const TipsSection = ({ isExpanded, onToggle, isOnline }) => {
  const [randomTip, setRandomTip] = useState(null);
  
  const getRandomTip = () => {
    // á”áŸ’ášá¾ TIP_DATABASE á‡áŸ†á“á½áŸ AI
    const random = TIP_DATABASE[Math.floor(Math.random() * TIP_DATABASE.length)];
    setRandomTip(random);
  };

  useEffect(() => {
     if(isExpanded && !randomTip) getRandomTip();
  }, [isExpanded]);

  return (
    <div className="mt-8">
      <button onClick={onToggle} className="w-full flex items-center justify-between bg-[#1e293b] p-4 rounded-xl border border-gray-800 shadow-sm hover:border-gray-500 transition-all group active:scale-95">
        <div className="flex items-center space-x-3"><div className="bg-blue-900/30 p-2 rounded-lg group-hover:bg-blue-900/50 transition-colors"><PlayCircle className="w-5 h-5 text-blue-400" /></div><h3 className="font-bold text-white text-lg font-khmer">á‚á“áŸ’á›á¹áŸ‡á”á“áŸ’ááŸ‚á˜ (Tips)</h3></div>
        <ChevronRight className={`w-5 h-5 text-gray-500 transition-transform ${isExpanded ? 'rotate-90' : ''}`} />
      </button>
      {isExpanded && (
        <div className="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 animate-fade-in-down">
          <div className="bg-gradient-to-br from-indigo-900/40 to-purple-900/40 border border-indigo-500/30 rounded-xl p-4 md:col-span-2 relative overflow-hidden backdrop-blur-sm">
             <div className="flex justify-between items-start mb-2"><h4 className="font-bold text-white font-khmer flex items-center gap-2 z-10"><Sparkles className="w-4 h-4 text-yellow-400" /> á‚á“áŸ’á›á¹áŸ‡á–á·áŸáŸáŸ (Pro Tip)</h4><button onClick={getRandomTip} className="z-10 bg-indigo-600 hover:bg-indigo-500 text-white text-xs px-3 py-1.5 rounded-full font-khmer transition-all shadow-lg hover:shadow-indigo-500/50"><Shuffle size={14} className="inline mr-1"/> á”áŸ’áá¼ášááŸ’á˜á¸</button></div>
             <p className="text-gray-200 text-sm font-khmer leading-relaxed border-l-2 border-indigo-500 pl-3 mt-2">{randomTip || "á…á»á…á”áŸŠá¼áá»á„áŠá¾á˜áŸ’á”á¸á‘á‘á½á›á”á¶á“á‚á“áŸ’á›á¹áŸ‡..."}</p>
          </div>
          <div className="bg-[#1e293b]/80 border border-gray-800 rounded-xl p-4 md:col-span-2">
            <h4 className="font-bold text-white font-khmer mb-3 flex items-center"><Zap className="w-4 h-4 mr-2 text-yellow-400" /> á‚á“áŸ’á›á¹áŸ‡á”áŸ’ášá¾á€á˜áŸ’á˜áœá·á’á¸ (Shortcut Tricks)</h4>
            <ul className="space-y-3 text-sm text-gray-300 font-khmer">
              <li className="flex items-start gap-2">
                <span className="font-bold text-blue-400">1.</span>
                <span><span className="font-bold text-white">á…á»á…áŸá„áŸ’á€ááŸ‹á›á¾ášá¼á”áŸ–</span> á˜á¾á›ášá¼á”á—á¶á–áŠá¾á˜ (Before) áŠá¾á˜áŸ’á”á¸á”áŸ’ášáŸ€á”á’áŸ€á”áŸ”</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="font-bold text-blue-400">2.</span>
                <span><span className="font-bold text-white">á…á»á…á–á¸ášáŠá„á›á¾ SlideráŸ–</span> ááŸ’ášá¡á”áŸ‹áá˜áŸ’á›áŸƒá“áŸ„áŸ‡á‘áŸ… 0 áœá·á‰ (Reset)áŸ”</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="font-bold text-blue-400">3.</span>
                <span><span className="font-bold text-white">á”áŸ’ášá¾á˜áŸ’ášá¶á˜áŠáŸƒá–á¸ášá›á¾ SlideráŸ–</span> (Whites/Blacks) áŠá¾á˜áŸ’á”á¸á˜á¾á›á€á“áŸ’á›áŸ‚á„áŠáŸ‚á›á”á¶ááŸ‹á–áŸááŸŒá˜á¶á“ (Clipping)áŸ”</span>
              </li>
            </ul>
          </div>
        </div>
      )}
    </div>
  );
};

const ContactSection = () => (
  <div className="mt-8 mb-4 border-t border-gray-800 pt-6"><h3 className="text-center text-gray-400 text-sm font-khmer mb-4">á‘áŸ†á“á¶á€áŸ‹á‘áŸ†á“á„ & áŸáŸ’áœáŸ‚á„á™á›áŸ‹á”á“áŸ’ááŸ‚á˜</h3><div className="flex justify-center space-x-4"><a href="https://web.facebook.com/mydesignpro" target="_blank" rel="noopener noreferrer" className="flex flex-col items-center group"><div className="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform"><FacebookIcon className="w-5 h-5 text-white" /></div><span className="text-xs text-gray-400 font-khmer mt-1">Facebook</span></a><a href="https://t.me/koymy" target="_blank" rel="noopener noreferrer" className="flex flex-col items-center group"><div className="w-10 h-10 bg-blue-400 rounded-full flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform"><Send className="w-5 h-5 text-white" /></div><span className="text-xs text-gray-400 font-khmer mt-1">Telegram</span></a><a href="https://myaffinity.gumroad.com" target="_blank" rel="noopener noreferrer" className="flex flex-col items-center group"><div className="w-10 h-10 bg-gray-700 rounded-full flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform"><Globe className="w-5 h-5 text-white" /></div><span className="text-xs text-gray-400 font-khmer mt-1">Website</span></a></div><p className="text-center text-gray-600 text-xs mt-6 font-khmer">Â© 2026 Lightroom My Design. All Right Reserved.</p></div>
);

const Quiz = ({ isOnline }) => {
  const [gameState, setGameState] = useState('menu');
  const [quizConfig, setQuizConfig] = useState({ level: 'beginner', amount: 10 });
  const [questions, setQuestions] = useState(QUESTION_DATABASE);
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [score, setScore] = useState(0);
  const [selectedOption, setSelectedOption] = useState(null);
  const [isAnswered, setIsAnswered] = useState(false);

  const startQuiz = () => {
    // á”áŸ’ášá¾ QUESTION_DATABASE á‡áŸ†á“á½áŸ AI
    let filtered = QUESTION_DATABASE; // á”áŸ’ášá¾ DB ááŸ’á˜á¸
    
    // Shuffle and slice
    const shuffled = [...filtered].sort(() => 0.5 - Math.random());
    const selected = shuffled.slice(0, quizConfig.amount);
    
    setQuestions(selected);
    setCurrentQuestion(0);
    setScore(0);
    setIsAnswered(false);
    setSelectedOption(null);
    setGameState('playing');
  };

  const handleAnswerOptionClick = (index) => {
    if (isAnswered) return;
    setSelectedOption(index);
    setIsAnswered(true);
    if (index === questions[currentQuestion].correct) setScore(score + 1);
  };

  const handleNextQuestion = () => {
    const nextQuestion = currentQuestion + 1;
    if (nextQuestion < questions.length) { setCurrentQuestion(nextQuestion); setIsAnswered(false); setSelectedOption(null); } else { setGameState('result'); }
  };

  const resetQuiz = () => { setGameState('menu'); setScore(0); setIsAnswered(false); setSelectedOption(null); setQuestions(QUESTION_DATABASE); };

  if (gameState === 'menu') return <div className="bg-[#1e293b] p-8 text-center rounded-2xl border border-gray-800 shadow-2xl max-w-lg mx-auto"><Award className="w-20 h-20 text-blue-500 mx-auto mb-6 drop-shadow-lg" /><h2 className="text-3xl font-bold text-white font-khmer mb-2">á€á¶ášá’áŸ’áœá¾ááŸáŸáŸ’ááŸá˜ááŸ’áá—á¶á–</h2><p className="text-gray-400 font-khmer mb-8">áŸá¶á€á›áŸ’á”á„á…áŸ†ááŸáŸ‡áŠá¹á„ášá”áŸáŸ‹á¢áŸ’á“á€á¢áŸ†á–á¸ Lightroom</p><div className="space-y-6"><div className="flex justify-center gap-2 items-center"><span className="text-gray-400 text-sm font-khmer mr-2">á…áŸ†á“á½á“áŸáŸ†áá½áš:</span>{[5, 10, 15].map(num => (<button key={num} onClick={() => setQuizConfig({...quizConfig, amount: num})} className={`w-10 h-10 rounded-lg font-bold transition-all ${quizConfig.amount === num ? 'bg-blue-600 text-white shadow-lg scale-110' : 'bg-[#0f172a] text-gray-400 border border-gray-700 hover:border-gray-500'}`}>{num}</button>))}</div>
  <div className="flex gap-2 flex-col">
      <button onClick={startQuiz} className="w-full py-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white rounded-xl font-bold font-khmer shadow-lg hover:shadow-blue-500/30 transition-all transform hover:-translate-y-1">á…á¶á”áŸ‹á•áŸ’áŠá¾á˜áŸáŸ†áá½áš</button>
  </div>
  </div></div>;
  
  if (gameState === 'result') {
      const percentage = questions.length > 0 ? Math.round((score / questions.length) * 100) : 0;
      return <div className="bg-[#1e293b] p-8 text-center rounded-2xl border border-gray-800 shadow-2xl max-w-lg mx-auto"><div className="relative w-32 h-32 mx-auto mb-6 flex items-center justify-center"><svg className="w-full h-full transform -rotate-90"><circle cx="64" cy="64" r="60" stroke="#334155" strokeWidth="8" fill="none" /><circle cx="64" cy="64" r="60" stroke={percentage > 70 ? "#22c55e" : percentage > 40 ? "#eab308" : "#ef4444"} strokeWidth="8" fill="none" strokeDasharray={377} strokeDashoffset={377 - (377 * percentage) / 100} className="transition-all duration-1000 ease-out" /></svg><div className="absolute text-3xl font-bold text-white">{percentage}%</div></div><h2 className="text-2xl font-bold text-white font-khmer mb-2">{percentage > 80 ? "á¢áŸáŸ’á…á¶ášáŸ’á™áá¶áŸáŸ‹!" : "á–áŸ’á™á¶á™á¶á˜á‘áŸ€á!"}</h2><p className="text-gray-400 font-khmer mb-8">á–á·á“áŸ’á‘á»ášá”áŸáŸ‹á¢áŸ’á“á€: <span className="text-white font-bold">{score}</span> / {questions.length}</p><button onClick={resetQuiz} className="px-8 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-khmer transition-all">áŸá¶á€á›áŸ’á”á„á˜áŸ’áá„á‘áŸ€á</button></div>;
  }

  const q = questions[currentQuestion];
  if (!q) return <div className="text-white text-center">No questions available.</div>;

  return (
    <div className="bg-[#1e293b] p-8 rounded-2xl border border-gray-800 shadow-2xl max-w-2xl mx-auto"><div className="flex justify-between mb-6"><span className="text-sm font-bold text-blue-400 bg-blue-400/10 px-3 py-1 rounded-full">áŸáŸ†áá½áš {currentQuestion + 1}/{questions.length}</span><span className="text-xs text-gray-500 uppercase tracking-wider mt-1">{q.level || 'General'}</span></div><h3 className="text-xl md:text-2xl font-bold text-white mb-8 font-khmer leading-relaxed">{q.question}</h3><div className="grid gap-3">{q.options.map((opt, i) => <button key={i} onClick={() => handleAnswerOptionClick(i)} className={`p-4 text-left rounded-xl border transition-all duration-200 font-khmer text-sm ${isAnswered ? (i === q.correct ? 'bg-green-500/20 border-green-500/50 text-green-200' : (i === selectedOption ? 'bg-red-500/20 border-red-500/50 text-red-200' : 'bg-[#0f172a] border-gray-800 text-gray-400 opacity-50')) : 'bg-[#0f172a] border-gray-700 text-gray-200 hover:bg-[#334155] hover:border-gray-500'}`}>{opt}</button>)}</div>{isAnswered && <div className="mt-8 flex justify-end"><button onClick={handleNextQuestion} className="px-8 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold font-khmer shadow-lg transition-all flex items-center gap-2">á”á“áŸ’á‘á¶á”áŸ‹ <ChevronRight size={18}/></button></div>}</div>
  );
};

const CircleIcon = ({color}) => <div className={`w-3 h-3 rounded-full bg-${color}-500 inline-block`}></div>;

const PresetGenerator = ({ isOnline }) => {
    const [styleInput, setStyleInput] = useState('');
    const [recipe, setRecipe] = useState(null);
    const [loading, setLoading] = useState(false);
    
    // ğŸ”¥ NEW: 15 Suggested Styles (Based on your request)
    const popularStyles = Object.keys(PRESET_DB).map(key => 
        key.charAt(0).toUpperCase() + key.slice(1) // Capitalize
    );

    const generateRecipe = async (styleOverride = null) => {
        const style = styleOverride || styleInput;
        // Normalize input
        const normalizedStyle = style.toLowerCase().trim();
        
        if (!style) return;
        setLoading(true);
        
        // 1. á–á·á“á·ááŸ’á™á€áŸ’á“á»á„ Database á˜á»á“ (Instant Load)
        if (PRESET_DB[normalizedStyle]) {
             await new Promise(r => setTimeout(r, 800)); // Fake AI delay for realism
             setRecipe(PRESET_DB[normalizedStyle]);
             setLoading(false);
             return;
        }

        // 2. á”á¾á‚áŸ’á˜á¶á“á€áŸ’á“á»á„ DB á‘á¾á”á áŸ… AI (Fallback)
        const prompt = `Create a Lightroom preset recipe for the style: "${style}". 
        Return strictly valid JSON with this structure: 
        { 
          "basic": { "Exposure": number (-5 to 5), "Contrast": number (-100 to 100), "Highlights": number, "Shadows": number, "Whites": number, "Blacks": number, "Temp": number, "Tint": number, "Vibrance": number, "Saturation": number }, 
          "detail": { "Sharpening": number (0-150), "Noise": number (0-100), "ColorNoise": number }, 
          "effects": { "Grain": number (0-100) }, 
          "curve": { "RGB": string ("S-Curve", "Linear", "Matte", "High Contrast", "Faded") }, 
          "colorMix": [array of 8 objects with "color" (Red, Orange, Yellow, Green, Aqua, Blue, Purple, Magenta), "h", "s", "l"], 
          "grading": { "Shadows": { "h": number, "s": number, "l": number }, "Midtones": { "h", "s", "l" }, "Highlights": { "h", "s", "l" }, "Blending": number, "Balance": number } 
        }`;
        
        const systemPrompt = "You are an expert Lightroom photo editor. Generate high-quality JSON presets.";
        const data = await callGemini(prompt, systemPrompt, true);

        if (data) {
            setRecipe(data);
        } else {
             // Fallback default
             setRecipe(PRESET_DB["teal & orange"]);
        }
        
        if (styleOverride) setStyleInput(styleOverride);
        setLoading(false);
    };

    const handleExport = () => { if (recipe) generateXMP(recipe, styleInput || "Preset"); };
    
    const Slider = ({ label, value, min = -100, max = 100 }) => (
        <div className="mb-3">
            <div className="flex justify-between text-[11px] text-gray-400 font-mono mb-1.5 uppercase tracking-wider">
                <span>{label}</span>
                <span className={value > 0 ? "text-blue-400" : value < 0 ? "text-red-400" : "text-gray-300"}>{value > 0 ? `+${value}` : value}</span>
            </div>
            <div className="relative h-2 bg-gray-800 rounded-full overflow-hidden">
                <div className={`absolute top-0 bottom-0 ${value === 0 ? 'hidden' : 'bg-gradient-to-r from-blue-600 to-cyan-500'}`}
                     style={{
                         left: value < 0 ? `${50 + (value / (max - min)) * 100}%` : '50%',
                         width: `${Math.abs(value) / (max - min) * 100}%`
                     }}
                />
                <div className="absolute top-0 bottom-0 w-0.5 bg-gray-500 left-1/2 -translate-x-1/2 opacity-50"></div>
            </div>
        </div>
    );

    return (
         <div className="bg-[#1e293b] rounded-2xl border border-gray-800 flex flex-col h-full max-w-4xl mx-auto overflow-hidden shadow-2xl">
            <div className="bg-[#0f172a] p-5 border-b border-gray-800"><h3 className="font-bold font-khmer text-white flex items-center gap-2 text-lg"><Sliders className="text-purple-400 w-6 h-6" /> á¢áŸ’á“á€á”á„áŸ’á€á¾áášá¼á”á˜á“áŸ’á AI âœ¨</h3></div>
            <div className="p-6 space-y-6 overflow-y-auto flex-1">
                <div className="flex gap-3"><input value={styleInput} onChange={(e) => setStyleInput(e.target.value)} placeholder="á”á‰áŸ’á…á¼á›ášá…á“á¶á”áŸá‘áŸ’á˜ (á§. Cyberpunk, Soft Wedding)..." className="flex-1 bg-[#0f172a] border border-gray-700 rounded-xl px-5 py-3 text-white focus:outline-none focus:border-blue-500 transition-colors font-khmer text-sm" /><button onClick={() => generateRecipe()} disabled={loading} className="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white px-6 py-3 rounded-xl font-bold font-khmer disabled:opacity-50 shadow-lg">{loading ? <Loader2 className="animate-spin" /> : 'á”á„áŸ’á€á¾á âœ¨'}</button></div>
                <div className="flex flex-wrap gap-2">
                    {/* Auto-generate buttons from DB */}
                    {popularStyles.map(s => (
                        <button key={s} onClick={() => generateRecipe(s)} className="px-4 py-2 bg-[#0f172a] border border-gray-700 hover:border-purple-500 hover:bg-[#334155] rounded-full text-xs text-gray-300 transition-all font-medium whitespace-nowrap">
                            {s}
                        </button>
                    ))}
                </div>
                {recipe && <div className="bg-[#0f172a] rounded-2xl p-6 border border-gray-800 animate-fade-in-down shadow-inner">
                    <button onClick={handleExport} className="w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white py-3.5 rounded-xl font-bold flex items-center justify-center gap-2 mb-8 shadow-lg font-khmer tracking-wide"><Download size={18} /> á‘á¶á‰á™á€ XMP (Export)</button>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                         <div className="bg-[#1e293b]/50 p-4 rounded-xl border border-gray-800">
                            <h5 className="text-xs font-bold text-gray-400 uppercase mb-4 flex items-center gap-2 pb-2 border-b border-gray-700"><Sun size={14} className="text-orange-400"/> Light & Color</h5>
                            <Slider label="Exposure" value={Math.round(recipe.basic.Exposure * 50)} /> 
                            <Slider label="Contrast" value={recipe.basic.Contrast} />
                            <Slider label="Highlights" value={recipe.basic.Highlights} />
                            <Slider label="Shadows" value={recipe.basic.Shadows} />
                            <Slider label="Whites" value={recipe.basic.Whites} />
                            <Slider label="Blacks" value={recipe.basic.Blacks} />
                             <div className="mt-6 pt-4 border-t border-gray-700">
                                <div className="grid grid-cols-2 gap-x-6">
                                    <Slider label="Temp" value={recipe.basic.Temp} />
                                    <Slider label="Tint" value={recipe.basic.Tint} />
                                    <Slider label="Vibrance" value={recipe.basic.Vibrance} />
                                    <Slider label="Saturation" value={recipe.basic.Saturation} />
                                </div>
                            </div>
                        </div>
                        <div className="bg-[#1e293b]/50 p-4 rounded-xl border border-gray-800 flex flex-col justify-between">
                             <h5 className="text-xs font-bold text-gray-400 uppercase mb-4 flex items-center gap-2 pb-2 border-b border-gray-700"><TrendingUp size={14} className="text-green-400"/> Curve</h5>
                             <div className="flex-1 flex items-center justify-center"><CurveVisualizer type={recipe.curve.RGB} /></div>
                        </div>
                    </div>
                    <div className="mt-6 pt-6 border-t border-gray-800">
                        <h5 className="text-xs font-bold text-gray-400 uppercase mb-4 flex items-center gap-2"><Palette size={14} className="text-pink-400"/> Color Mix</h5>
                         <div className="grid grid-cols-2 md:grid-cols-4 gap-3 text-[10px] font-mono">
                            {recipe.colorMix.map((c) => (
                                <div key={c.color} className="flex justify-between items-center bg-[#1e293b] p-2 rounded-lg border border-gray-700">
                                    <div className="flex items-center gap-2"><div className={`w-2 h-2 rounded-full ${c.color === 'Red' ? 'bg-red-500' : c.color === 'Green' ? 'bg-green-500' : c.color === 'Blue' ? 'bg-blue-500' : 'bg-gray-500'}`}></div><span className="font-bold text-gray-300">{c.color}</span></div>
                                    <div className="flex flex-col text-gray-500 text-[8px]"><span>H {c.h}</span><span>S {c.s}</span><span>L {c.l}</span></div>
                                </div>
                            ))}
                         </div>
                    </div>
                     <div className="mt-6 pt-6 border-t border-gray-800">
                        <h5 className="text-xs font-bold text-gray-400 uppercase mb-4 flex items-center gap-2"><CircleIcon color="purple"/> Color Grading</h5>
                        <div className="grid grid-cols-3 gap-6">
                            <ColorWheel h={recipe.grading.Shadows.h} s={recipe.grading.Shadows.s} l={recipe.grading.Shadows.l} label="Shadows" />
                            <ColorWheel h={recipe.grading.Midtones.h} s={recipe.grading.Midtones.s} l={recipe.grading.Midtones.l} label="Midtones" />
                            <ColorWheel h={recipe.grading.Highlights.h} s={recipe.grading.Highlights.s} l={recipe.grading.Highlights.l} label="Highlights" />
                        </div>
                    </div>
                </div>}
            </div>
        </div>
    );
};

const ChatBot = ({ isOnline }) => {
Â  const [messages, setMessages] = useState([{ role: 'model', text: 'áŸá½áŸáŸ’áŠá¸! ááŸ’á‰á»áŸ†á‡á¶á‚áŸ’ášá¼á‡áŸ†á“á½á™ AIáŸ” á¢áŸ’á“á€á¢á¶á…áŸá½ášááŸ’á‰á»áŸ†á¢áŸ†á–á¸ášá”áŸ€á”á€áŸ‚ášá¼á” á¬á¢áŸ„á™ááŸ’á‰á»áŸ†ááŸ‚á“á¶áŸ† SettingáŸ”' }]);
Â  const [input, setInput] = useState('');
Â  const [loading, setLoading] = useState(false);
Â  const messagesEndRef = useRef(null);
Â  
Â  const suggestedQuestionsPool = ["áá¾ Dehaze á”áŸ’ášá¾áŸá˜áŸ’ášá¶á”áŸ‹á¢áŸ’áœá¸?", "á…á„áŸ‹á€áŸ‚ášá¼á”á”áŸ‚á” Vintage", "ášá¼á”á„á„á¹áá–áŸá€ á’áŸ’áœá¾á˜áŸ‰áŸá…?", "áŸá»áŸ†ášá¼á”á˜á“áŸ’áá€áŸ‚ášá¼á”á”áŸ‚á” Cinematic", "ášá”áŸ€á”á’áŸ’áœá¾á¢áŸ„á™áŸáŸ’á”áŸ‚á€áŸ?", "á€áŸ‚ášá¼á”ááá–áŸá›á™á”áŸ‹á¢áŸ„á™áŸáŸ’á¢á¶á", "ášá”áŸ€á”áŠá¶á€áŸ‹á–ááŸŒ Teal & Orange", "á–á“áŸ’á™á›áŸ‹á–á¸ Curves", "áá¾ Grain á‡á½á™á¢áŸ’áœá¸ááŸ’á›áŸ‡?", "ášá”áŸ€á”á€áŸ‚ášá¼á” Portrait á¢áŸ„á™áŸáŸ’á¢á¶á"];
Â  const [suggestions, setSuggestions] = useState([]);

Â  useEffect(() => {
Â  Â  const shuffled = [...suggestedQuestionsPool].sort(() => 0.5 - Math.random());
Â  Â  setSuggestions(shuffled.slice(0, 3));
Â  }, []);

Â  const randomizeSuggestions = () => {
Â  Â  const shuffled = [...suggestedQuestionsPool].sort(() => 0.5 - Math.random());
Â  Â  setSuggestions(shuffled.slice(0, 3));
Â  };

Â  const handleSend = async (text = null) => {
Â  Â  const msg = text || input;
Â  Â  if (!msg.trim()) return;
Â  Â  setInput('');
Â  Â  setMessages(prev => [...prev, { role: 'user', text: msg }]);
Â  Â  setLoading(true);

    // ğŸ”¥ NEW: Check Cache First
    if (AI_CACHE_DB[msg]) {
        await new Promise(r => setTimeout(r, 500)); // Fake delay for realism
        setMessages(prev => [...prev, { role: 'model', text: AI_CACHE_DB[msg] }]);
        setLoading(false);
        return;
    }

Â  Â  const systemPrompt = "You are a friendly, expert Lightroom and photography assistant speaking Khmer. You STRICTLY only answer questions related to Adobe Lightroom, photo editing, color grading, photography techniques, and camera settings. If a user asks about anything else (e.g., general knowledge, math, politics, sports), politely apologize in Khmer and state that you can only help with photography and Lightroom matters. When suggesting settings, format the response as a clean list with bullet points and provide specific numerical values (e.g., â€¢ Exposure: +0.20) for better readability.";
Â  Â  let reply = await callGemini(msg, systemPrompt);
Â  Â  
Â  Â  if (!reply) {
Â  Â  Â  Â  if (!apiKey) {
Â  Â  Â  Â  Â  Â  reply = "âš ï¸ áŸá¼á˜á”á‰áŸ’á…á¼á› Gemini API Key á“áŸ…á€áŸ’á“á»á„ Vercel áŠá¾á˜áŸ’á”á¸á±áŸ’á™ááŸ’á‰á»áŸ†á¢á¶á…á†áŸ’á›á¾á™áá”á”á¶á“áŸ” (áŸá¼á˜á…á¼á›á‘áŸ…á€á¶á“áŸ‹ Settings -> Environment Variables -> á”á“áŸ’ááŸ‚á˜ VITE_GEMINI_API_KEY)";
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  reply = "áŸá»áŸ†á‘áŸ„áŸ á˜á¶á“á”á‰áŸ’á á¶á”á…áŸ’á…áŸá€á‘áŸáŸá€áŸ’á“á»á„á€á¶ášá—áŸ’á‡á¶á”áŸ‹á‘áŸ…á€á¶á“áŸ‹ AIáŸ” áŸá¼á˜á–áŸ’á™á¶á™á¶á˜á˜áŸ’áá„á‘áŸ€áá“áŸ…á–áŸá›á€áŸ’ášáŸ„á™áŸ”";
Â  Â  Â  Â  }
Â  Â  }

Â  Â  setMessages(prev => [...prev, { role: 'model', text: reply }]);
Â  Â  setLoading(false);
Â  };
Â  
Â  useEffect(() => messagesEndRef.current?.scrollIntoView({ behavior: "smooth" }), [messages]);

Â  return (
Â  Â  <div className="bg-[#1e293b] rounded-2xl overflow-hidden border border-gray-800 shadow-2xl flex flex-col h-full max-w-4xl mx-auto">
Â  Â  Â  <div className="bg-gradient-to-r from-purple-900/50 to-blue-900/50 p-4 border-b border-gray-800 flex items-center space-x-3"><div className="bg-gradient-to-br from-purple-500 to-blue-500 p-2.5 rounded-xl shadow-lg shadow-purple-500/20"><Bot className="w-5 h-5 text-white" /></div><div><h3 className="font-bold text-white font-khmer">á‚áŸ’ášá¼á‡áŸ†á“á½á™ AI</h3><p className="text-xs text-blue-200 font-khmer">Powered by Gemini âœ¨</p></div></div>
Â  Â  Â  <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-[#0f172a]">{messages.map((m, i) => <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}><div className={`p-3.5 rounded-2xl max-w-[85%] text-sm font-khmer leading-relaxed shadow-sm whitespace-pre-wrap ${m.role === 'user' ? 'bg-blue-600 text-white rounded-br-none' : 'bg-[#1e293b] text-gray-200 rounded-bl-none border border-gray-700'}`}>{m.text}</div></div>)}
Â  Â  Â  Â  {loading && <div className="flex justify-start"><div className="p-3.5 rounded-2xl bg-[#1e293b] border border-gray-700 rounded-bl-none"><Loader2 className="w-4 h-4 text-purple-400 animate-spin" /></div></div>}
Â  Â  Â  Â  <div ref={messagesEndRef} />
Â  Â  Â  </div>
Â  Â  Â  <div className="p-4 bg-[#1e293b] border-t border-gray-800">
Â  Â  Â  Â  Â  <div className="flex gap-2 items-center mb-3"><button onClick={randomizeSuggestions} className="p-1.5 bg-[#0f172a] hover:bg-[#334155] rounded-full text-gray-400 hover:text-white transition-all"><RefreshCw className="w-3 h-3" /></button><div className="flex gap-2 overflow-x-auto pb-1 no-scrollbar">{suggestions.map((q, i) => <button key={i} onClick={() => handleSend(q)} className="whitespace-nowrap px-3 py-1.5 bg-[#0f172a] hover:bg-[#334155] hover:border-blue-500 rounded-full text-xs text-gray-300 border border-gray-700 transition-all font-khmer">{q}</button>)}</div></div>
Â  Â  Â  Â  Â  <div className="flex gap-2"><input value={input} onChange={e => setInput(e.target.value)} onKeyPress={e => e.key === 'Enter' && handleSend()} placeholder="áŸá½ášá¢áŸ’áœá¸á˜á½á™..." className="flex-1 bg-[#0f172a] border border-gray-700 rounded-xl px-5 py-3 text-sm text-white focus:outline-none focus:border-blue-500 font-khmer transition-colors" /><button onClick={() => handleSend()} disabled={loading} className="bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 p-3 rounded-xl text-white shadow-lg disabled:opacity-50"><Send size={18}/></button></div>
Â  Â  Â  </div>
Â  Â  </div>
Â  );
};

const AIAssistant = ({ isOnline }) => {
Â  Â  const [mode, setMode] = useState('chat');
Â  Â  return (
Â  Â  Â  Â  <div className="h-[75vh] min-h-[600px] flex flex-col">
Â  Â  Â  Â  Â  Â  <div className="flex justify-center mb-6 bg-[#0f172a] p-1.5 rounded-xl self-center border border-gray-800 shadow-md"><button onClick={() => setMode('chat')} className={`px-6 py-2 rounded-lg text-sm font-khmer transition-all ${mode === 'chat' ? 'bg-[#1e293b] text-white shadow-md border border-gray-700' : 'text-gray-400 hover:text-white'}`}>á‚áŸ’ášá¼á‡áŸ†á“á½á™ AI</button><button onClick={() => setMode('preset')} className={`px-6 py-2 rounded-lg text-sm font-khmer transition-all ${mode === 'preset' ? 'bg-[#1e293b] text-white shadow-md border border-gray-700' : 'text-gray-400 hover:text-white'}`}>á”á„áŸ’á€á¾áášá¼á”á˜á“áŸ’á AI</button></div>
Â  Â  Â  Â  Â  Â  <div className="flex-1 overflow-hidden">{mode === 'chat' ? <ChatBot isOnline={isOnline} /> : <PresetGenerator isOnline={isOnline} />}</div>
Â  Â  Â  Â  </div>
Â  Â  );
};

// --- APP COMPONENT (LAST) ---
export default function App() {
Â  const [activeTab, setActiveTab] = useState('learn');
Â  const [expandedLesson, setExpandedLesson] = useState(null);
Â  const [expandedSection, setExpandedSection] = useState(null);
Â  const [isOnline, setIsOnline] = useState(true);

Â  const toggleSection = (id) => setExpandedSection(prev => prev === id ? null : id);

Â  return (
Â  Â  <div className="min-h-screen bg-[#0f172a] text-gray-100 font-sans pb-24 md:pb-0 selection:bg-blue-500/30">
Â  Â  Â  <style>{`@import url('https://fonts.googleapis.com/css2?family=Kantumruy+Pro:wght@100..700&family=Inter:wght@400;500;600;700&display=swap'); .font-khmer { font-family: 'Kantumruy Pro', sans-serif; } .no-scrollbar::-webkit-scrollbar { display: none; } @keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } } .animate-fade-in-down { animation: fade-in-down 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }`}</style>
Â  Â  Â  <Header activeTab={activeTab} setActiveTab={setActiveTab} />
Â  Â  Â  {expandedLesson && <LessonModal lesson={lessonsData.find(l => l.id === expandedLesson)} onClose={() => setExpandedLesson(null)} />}
Â  Â  Â  <main className="max-w-6xl mx-auto p-4 pt-8 md:p-8">
Â  Â  Â  Â  <div className="animate-fade-in-down">
Â  Â  Â  Â  Â  {activeTab === 'learn' && (<div className="space-y-8"><div className="text-center mb-8"><h2 className="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400 mb-3 font-khmer">áœá‚áŸ’á‚áŸá·á€áŸ’áŸá¶ Lightroom</h2><p className="text-gray-400 font-khmer max-w-lg mx-auto">ášáŸ€á“á–á¸á˜á¼á›áŠáŸ’á‹á¶á“á‚áŸ’ášá¹áŸ‡áŠá›áŸ‹á€á˜áŸ’ášá·áááŸ’á–áŸáŸ‹á“áŸƒá€á¶ášá€áŸ‚ášá¼á”á—á¶á–áŸ”</p></div><div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">{lessonsData.map(lesson => <LessonCard key={lesson.id} lesson={lesson} onClick={() => setExpandedLesson(lesson.id)} />)}</div><TipsSection isExpanded={expandedSection === 'tips'} onToggle={() => toggleSection('tips')} isOnline={isOnline} /><ContactSection /></div>)}
Â  Â  Â  Â  Â  {activeTab === 'quiz' && <Quiz isOnline={isOnline} />}
Â  Â  Â  Â  Â  {activeTab === 'ai' && <AIAssistant isOnline={isOnline} />}
Â  Â  Â  Â  </div>
Â  Â  Â  </main>
Â  Â  Â  <div className="md:hidden fixed bottom-0 left-0 right-0 bg-[#0f172a]/90 backdrop-blur-md border-t border-gray-800 pb-safe z-40 flex justify-around p-2">
Â  Â  Â  Â  Â <button onClick={() => setActiveTab('learn')} className={`flex flex-col items-center p-2 rounded-xl transition-all ${activeTab === 'learn' ? 'text-blue-400 bg-blue-500/10' : 'text-gray-500 hover:text-gray-300'}`}><BookOpen size={20}/><span className="text-[10px] font-khmer mt-1">á˜áŸášáŸ€á“</span></button>
Â  Â  Â  Â  Â <button onClick={() => setActiveTab('quiz')} className={`flex flex-col items-center p-2 rounded-xl transition-all ${activeTab === 'quiz' ? 'text-blue-400 bg-blue-500/10' : 'text-gray-500 hover:text-gray-300'}`}><Award size={20}/><span className="text-[10px] font-khmer mt-1">ááŸáŸáŸ’á</span></button>
Â  Â  Â  Â  Â <button onClick={() => setActiveTab('ai')} className={`flex flex-col items-center p-2 rounded-xl transition-all ${activeTab === 'ai' ? 'text-blue-400 bg-blue-500/10' : 'text-gray-500 hover:text-gray-300'}`}><Sparkles size={20}/><span className="text-[10px] font-khmer mt-1">á‚áŸ’ášá¼ AI</span></button>
Â  Â  Â  </div>
Â  Â  </div>
Â  );
}